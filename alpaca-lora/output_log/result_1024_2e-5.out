/home/tricorder/yang/anaconda3/envs/llama_alpaca_lora/lib/python3.10/site-packages/bitsandbytes/cuda_setup/main.py:145: UserWarning: /home/tricorder/yang/anaconda3/envs/llama_alpaca_lora did not contain ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] as expected! Searching further paths...
  warn(msg)

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please run

python -m bitsandbytes

 and submit this information together with your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
bin /home/tricorder/yang/anaconda3/envs/llama_alpaca_lora/lib/python3.10/site-packages/bitsandbytes/libbitsandbytes_cuda117.so
CUDA SETUP: CUDA runtime path found: /usr/local/cuda-11.7/lib64/libcudart.so.11.0
CUDA SETUP: Highest compute capability among GPUs detected: 8.0
CUDA SETUP: Detected CUDA version 117
CUDA SETUP: Loading binary /home/tricorder/yang/anaconda3/envs/llama_alpaca_lora/lib/python3.10/site-packages/bitsandbytes/libbitsandbytes_cuda117.so...
Training Alpaca-LoRA model with params:
base_model: /home/tricorder/test/gxc/decapoda-research/llama-7b-hf
data_path: ../data/alpaca_data.json
output_dir: ../lora_alpaca_output_free/source_2048
batch_size: 1024
micro_batch_size: 4
num_epochs: 3
learning_rate: 2e-05
cutoff_len: 512
val_set_size: 2000
lora_r: 8
lora_alpha: 16
lora_dropout: 0.05
lora_target_modules: ['q_proj', 'v_proj']
train_on_inputs:  
add_eos_token:  
group_by_length: True
wandb_project: llama_test_project
wandb_run_name:  
wandb_watch: gradients
wandb_log_model:  
resume_from_checkpoint:  
prompt template: alpaca

Loading checkpoint shards:   0%|          | 0/33 [00:00<?, ?it/s]Loading checkpoint shards:   3%|▎         | 1/33 [00:02<01:21,  2.54s/it]Loading checkpoint shards:   6%|▌         | 2/33 [00:04<01:15,  2.44s/it]Loading checkpoint shards:   9%|▉         | 3/33 [00:07<01:14,  2.49s/it]Loading checkpoint shards:  12%|█▏        | 4/33 [00:09<01:11,  2.46s/it]Loading checkpoint shards:  15%|█▌        | 5/33 [00:12<01:09,  2.50s/it]Loading checkpoint shards:  18%|█▊        | 6/33 [00:14<01:06,  2.48s/it]Loading checkpoint shards:  21%|██        | 7/33 [00:17<01:04,  2.47s/it]Loading checkpoint shards:  24%|██▍       | 8/33 [00:19<01:02,  2.51s/it]Loading checkpoint shards:  27%|██▋       | 9/33 [00:22<00:59,  2.49s/it]Loading checkpoint shards:  30%|███       | 10/33 [00:24<00:56,  2.45s/it]Loading checkpoint shards:  33%|███▎      | 11/33 [00:27<00:54,  2.48s/it]Loading checkpoint shards:  36%|███▋      | 12/33 [00:29<00:51,  2.46s/it]Loading checkpoint shards:  39%|███▉      | 13/33 [00:32<00:49,  2.46s/it]Loading checkpoint shards:  42%|████▏     | 14/33 [00:34<00:46,  2.46s/it]Loading checkpoint shards:  45%|████▌     | 15/33 [00:37<00:44,  2.45s/it]Loading checkpoint shards:  48%|████▊     | 16/33 [00:39<00:40,  2.39s/it]Loading checkpoint shards:  52%|█████▏    | 17/33 [00:41<00:38,  2.44s/it]Loading checkpoint shards:  55%|█████▍    | 18/33 [00:44<00:35,  2.40s/it]Loading checkpoint shards:  58%|█████▊    | 19/33 [00:46<00:33,  2.39s/it]Loading checkpoint shards:  61%|██████    | 20/33 [00:49<00:31,  2.44s/it]Loading checkpoint shards:  64%|██████▎   | 21/33 [00:51<00:29,  2.42s/it]Loading checkpoint shards:  67%|██████▋   | 22/33 [00:53<00:26,  2.45s/it]Loading checkpoint shards:  70%|██████▉   | 23/33 [00:56<00:24,  2.43s/it]Loading checkpoint shards:  73%|███████▎  | 24/33 [00:58<00:21,  2.43s/it]Loading checkpoint shards:  76%|███████▌  | 25/33 [01:01<00:19,  2.40s/it]Loading checkpoint shards:  79%|███████▉  | 26/33 [01:03<00:16,  2.41s/it]Loading checkpoint shards:  82%|████████▏ | 27/33 [01:06<00:14,  2.45s/it]Loading checkpoint shards:  85%|████████▍ | 28/33 [01:08<00:12,  2.46s/it]Loading checkpoint shards:  88%|████████▊ | 29/33 [01:10<00:09,  2.44s/it]Loading checkpoint shards:  91%|█████████ | 30/33 [01:13<00:07,  2.45s/it]Loading checkpoint shards:  94%|█████████▍| 31/33 [01:15<00:04,  2.43s/it]Loading checkpoint shards:  97%|█████████▋| 32/33 [01:18<00:02,  2.44s/it]Loading checkpoint shards: 100%|██████████| 33/33 [01:21<00:00,  2.63s/it]Loading checkpoint shards: 100%|██████████| 33/33 [01:21<00:00,  2.47s/it]
The tokenizer class you load from this checkpoint is not the same type as the class this function is called from. It may result in unexpected tokenization. 
The tokenizer class you load from this checkpoint is 'LLaMATokenizer'. 
The class this function is called from is 'LlamaTokenizer'.
Found cached dataset json (/home/tricorder/yang/datasets/json/default-50b57c6e99b706ed/0.0.0/e347ab1c932092252e717ff3f949105a4dd28b27e842dd53157d2f72e276c2e4)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00,  5.39it/s]100%|██████████| 1/1 [00:00<00:00,  5.38it/s]
Loading cached split indices for dataset at /home/tricorder/yang/datasets/json/default-50b57c6e99b706ed/0.0.0/e347ab1c932092252e717ff3f949105a4dd28b27e842dd53157d2f72e276c2e4/cache-221ef8c5005ddf18.arrow and /home/tricorder/yang/datasets/json/default-50b57c6e99b706ed/0.0.0/e347ab1c932092252e717ff3f949105a4dd28b27e842dd53157d2f72e276c2e4/cache-493ce87b5905320b.arrow
Checkpoint  /adapter_model.bin not found
trainable params: 4194304 || all params: 6742609920 || trainable%: 0.06220594176090199
Map:   0%|          | 0/50002 [00:00<?, ? examples/s]Map:   0%|          | 102/50002 [00:00<00:49, 1005.00 examples/s]Map:   0%|          | 213/50002 [00:00<00:47, 1057.54 examples/s]Map:   1%|          | 333/50002 [00:00<00:44, 1117.49 examples/s]Map:   1%|          | 490/50002 [00:00<00:45, 1076.95 examples/s]Map:   1%|          | 602/50002 [00:00<00:45, 1083.86 examples/s]Map:   1%|▏         | 712/50002 [00:00<00:45, 1087.69 examples/s]Map:   2%|▏         | 866/50002 [00:00<00:46, 1054.50 examples/s]Map:   2%|▏         | 1000/50002 [00:00<00:51, 947.44 examples/s]Map:   2%|▏         | 1106/50002 [00:01<00:50, 972.07 examples/s]Map:   2%|▏         | 1224/50002 [00:01<00:47, 1023.80 examples/s]Map:   3%|▎         | 1330/50002 [00:01<00:47, 1031.15 examples/s]Map:   3%|▎         | 1450/50002 [00:01<00:45, 1073.44 examples/s]Map:   3%|▎         | 1566/50002 [00:01<00:44, 1097.44 examples/s]Map:   3%|▎         | 1681/50002 [00:01<00:43, 1108.81 examples/s]Map:   4%|▎         | 1850/50002 [00:01<00:43, 1107.54 examples/s]Map:   4%|▍         | 1965/50002 [00:01<00:43, 1116.23 examples/s]Map:   4%|▍         | 2109/50002 [00:02<00:47, 1013.02 examples/s]Map:   4%|▍         | 2226/50002 [00:02<00:45, 1049.07 examples/s]Map:   5%|▍         | 2341/50002 [00:02<00:44, 1072.40 examples/s]Map:   5%|▍         | 2458/50002 [00:02<00:43, 1096.72 examples/s]Map:   5%|▌         | 2626/50002 [00:02<00:43, 1099.87 examples/s]Map:   6%|▌         | 2792/50002 [00:02<00:42, 1099.01 examples/s]Map:   6%|▌         | 2976/50002 [00:02<00:41, 1134.34 examples/s]Map:   6%|▋         | 3134/50002 [00:02<00:42, 1094.68 examples/s]Map:   7%|▋         | 3273/50002 [00:03<00:40, 1160.82 examples/s]Map:   7%|▋         | 3404/50002 [00:03<00:38, 1196.75 examples/s]Map:   7%|▋         | 3536/50002 [00:03<00:37, 1226.65 examples/s]Map:   7%|▋         | 3677/50002 [00:03<00:36, 1273.14 examples/s]Map:   8%|▊         | 3871/50002 [00:03<00:36, 1274.52 examples/s]Map:   8%|▊         | 4000/50002 [00:03<00:38, 1202.01 examples/s]Map:   8%|▊         | 4139/50002 [00:03<00:36, 1247.72 examples/s]Map:   9%|▊         | 4276/50002 [00:03<00:40, 1123.86 examples/s]Map:   9%|▉         | 4420/50002 [00:04<00:42, 1064.68 examples/s]Map:   9%|▉         | 4563/50002 [00:04<00:39, 1150.95 examples/s]Map:   9%|▉         | 4701/50002 [00:04<00:37, 1208.97 examples/s]Map:  10%|▉         | 4852/50002 [00:04<00:39, 1133.32 examples/s]Map:  10%|▉         | 5000/50002 [00:04<00:43, 1044.11 examples/s]Map:  10%|█         | 5144/50002 [00:04<00:39, 1135.43 examples/s]Map:  11%|█         | 5284/50002 [00:04<00:37, 1197.98 examples/s]Map:  11%|█         | 5424/50002 [00:04<00:35, 1247.66 examples/s]Map:  11%|█         | 5562/50002 [00:04<00:34, 1280.86 examples/s]Map:  11%|█▏        | 5701/50002 [00:05<00:33, 1307.56 examples/s]Map:  12%|█▏        | 5835/50002 [00:05<00:33, 1313.05 examples/s]Map:  12%|█▏        | 5974/50002 [00:05<00:37, 1160.30 examples/s]Map:  12%|█▏        | 6136/50002 [00:05<00:39, 1098.38 examples/s]Map:  13%|█▎        | 6267/50002 [00:05<00:38, 1147.02 examples/s]Map:  13%|█▎        | 6405/50002 [00:05<00:36, 1202.48 examples/s]Map:  13%|█▎        | 6541/50002 [00:05<00:39, 1091.84 examples/s]Map:  13%|█▎        | 6677/50002 [00:05<00:37, 1158.39 examples/s]Map:  14%|█▎        | 6813/50002 [00:06<00:35, 1209.63 examples/s]Map:  14%|█▍        | 6949/50002 [00:06<00:34, 1249.83 examples/s]Map:  14%|█▍        | 7122/50002 [00:06<00:41, 1036.24 examples/s]Map:  15%|█▍        | 7261/50002 [00:06<00:38, 1115.79 examples/s]Map:  15%|█▍        | 7400/50002 [00:06<00:36, 1183.09 examples/s]Map:  15%|█▌        | 7542/50002 [00:06<00:34, 1240.95 examples/s]Map:  15%|█▌        | 7674/50002 [00:06<00:33, 1256.27 examples/s]Map:  16%|█▌        | 7808/50002 [00:06<00:33, 1278.50 examples/s]Map:  16%|█▌        | 7942/50002 [00:06<00:32, 1295.32 examples/s]Map:  16%|█▋        | 8140/50002 [00:07<00:34, 1205.31 examples/s]Map:  17%|█▋        | 8271/50002 [00:07<00:34, 1227.22 examples/s]Map:  17%|█▋        | 8446/50002 [00:07<00:34, 1199.71 examples/s]Map:  17%|█▋        | 8587/50002 [00:07<00:33, 1247.61 examples/s]Map:  17%|█▋        | 8719/50002 [00:07<00:32, 1263.51 examples/s]Map:  18%|█▊        | 8862/50002 [00:07<00:35, 1146.58 examples/s]Map:  18%|█▊        | 8983/50002 [00:07<00:35, 1157.10 examples/s]Map:  18%|█▊        | 9137/50002 [00:07<00:36, 1106.66 examples/s]Map:  19%|█▊        | 9280/50002 [00:08<00:34, 1184.81 examples/s]Map:  19%|█▉        | 9439/50002 [00:08<00:35, 1138.10 examples/s]Map:  19%|█▉        | 9569/50002 [00:08<00:34, 1177.44 examples/s]Map:  19%|█▉        | 9713/50002 [00:08<00:32, 1243.47 examples/s]Map:  20%|█▉        | 9859/50002 [00:08<00:30, 1300.07 examples/s]Map:  20%|█▉        | 10000/50002 [00:08<00:38, 1030.59 examples/s]Map:  20%|██        | 10124/50002 [00:08<00:36, 1077.99 examples/s]Map:  21%|██        | 10259/50002 [00:08<00:34, 1143.18 examples/s]Map:  21%|██        | 10393/50002 [00:09<00:33, 1190.84 examples/s]Map:  21%|██        | 10524/50002 [00:09<00:36, 1072.76 examples/s]Map:  21%|██▏       | 10661/50002 [00:09<00:34, 1145.48 examples/s]Map:  22%|██▏       | 10790/50002 [00:09<00:33, 1182.13 examples/s]Map:  22%|██▏       | 10950/50002 [00:09<00:34, 1137.89 examples/s]Map:  22%|██▏       | 11138/50002 [00:09<00:34, 1123.67 examples/s]Map:  23%|██▎       | 11277/50002 [00:09<00:32, 1185.10 examples/s]Map:  23%|██▎       | 11417/50002 [00:09<00:31, 1236.69 examples/s]Map:  23%|██▎       | 11551/50002 [00:10<00:30, 1262.28 examples/s]Map:  23%|██▎       | 11694/50002 [00:10<00:29, 1307.57 examples/s]Map:  24%|██▎       | 11830/50002 [00:10<00:28, 1319.37 examples/s]Map:  24%|██▍       | 11976/50002 [00:10<00:28, 1356.69 examples/s]Map:  24%|██▍       | 12132/50002 [00:10<00:30, 1232.10 examples/s]Map:  25%|██▍       | 12268/50002 [00:10<00:29, 1262.53 examples/s]Map:  25%|██▍       | 12406/50002 [00:10<00:29, 1293.24 examples/s]Map:  25%|██▌       | 12548/50002 [00:10<00:28, 1325.35 examples/s]Map:  25%|██▌       | 12746/50002 [00:10<00:28, 1317.21 examples/s]Map:  26%|██▌       | 12943/50002 [00:11<00:28, 1313.12 examples/s]Map:  26%|██▋       | 13144/50002 [00:11<00:29, 1245.63 examples/s]Map:  27%|██▋       | 13289/50002 [00:11<00:28, 1290.16 examples/s]Map:  27%|██▋       | 13479/50002 [00:11<00:28, 1278.12 examples/s]Map:  27%|██▋       | 13617/50002 [00:11<00:27, 1299.98 examples/s]Map:  28%|██▊       | 13813/50002 [00:11<00:27, 1300.48 examples/s]Map:  28%|██▊       | 13945/50002 [00:11<00:27, 1303.35 examples/s]Map:  28%|██▊       | 14138/50002 [00:12<00:28, 1242.72 examples/s]Map:  29%|██▊       | 14270/50002 [00:12<00:28, 1258.45 examples/s]Map:  29%|██▉       | 14419/50002 [00:12<00:27, 1315.75 examples/s]Map:  29%|██▉       | 14556/50002 [00:12<00:26, 1327.04 examples/s]Map:  29%|██▉       | 14697/50002 [00:12<00:26, 1346.90 examples/s]Map:  30%|██▉       | 14896/50002 [00:12<00:26, 1335.61 examples/s]Map:  30%|███       | 15070/50002 [00:12<00:27, 1264.28 examples/s]Map:  30%|███       | 15204/50002 [00:12<00:27, 1277.76 examples/s]Map:  31%|███       | 15341/50002 [00:12<00:26, 1299.37 examples/s]Map:  31%|███       | 15481/50002 [00:13<00:26, 1324.41 examples/s]Map:  31%|███▏      | 15679/50002 [00:13<00:25, 1320.88 examples/s]Map:  32%|███▏      | 15813/50002 [00:13<00:25, 1318.54 examples/s]Map:  32%|███▏      | 15947/50002 [00:13<00:25, 1323.52 examples/s]Map:  32%|███▏      | 16136/50002 [00:13<00:27, 1227.19 examples/s]Map:  33%|███▎      | 16274/50002 [00:13<00:26, 1260.14 examples/s]Map:  33%|███▎      | 16413/50002 [00:13<00:25, 1292.14 examples/s]Map:  33%|███▎      | 16552/50002 [00:13<00:25, 1315.90 examples/s]Map:  33%|███▎      | 16694/50002 [00:13<00:24, 1342.18 examples/s]Map:  34%|███▎      | 16835/50002 [00:14<00:24, 1358.04 examples/s]Map:  34%|███▍      | 16975/50002 [00:14<00:24, 1366.08 examples/s]Map:  34%|███▍      | 17133/50002 [00:14<00:26, 1241.73 examples/s]Map:  35%|███▍      | 17281/50002 [00:14<00:25, 1302.35 examples/s]Map:  35%|███▍      | 17485/50002 [00:14<00:24, 1320.42 examples/s]Map:  35%|███▌      | 17621/50002 [00:14<00:24, 1328.68 examples/s]Map:  36%|███▌      | 17756/50002 [00:14<00:24, 1331.80 examples/s]Map:  36%|███▌      | 17897/50002 [00:14<00:23, 1349.52 examples/s]Map:  36%|███▌      | 18063/50002 [00:15<00:26, 1213.00 examples/s]Map:  36%|███▋      | 18196/50002 [00:15<00:25, 1242.21 examples/s]Map:  37%|███▋      | 18334/50002 [00:15<00:24, 1275.83 examples/s]Map:  37%|███▋      | 18468/50002 [00:15<00:24, 1289.80 examples/s]Map:  37%|███▋      | 18617/50002 [00:15<00:23, 1340.76 examples/s]Map:  38%|███▊      | 18816/50002 [00:15<00:23, 1332.63 examples/s]Map:  38%|███▊      | 19000/50002 [00:15<00:25, 1230.24 examples/s]Map:  38%|███▊      | 19136/50002 [00:15<00:24, 1257.97 examples/s]Map:  39%|███▊      | 19278/50002 [00:15<00:23, 1295.60 examples/s]Map:  39%|███▉      | 19413/50002 [00:16<00:23, 1306.67 examples/s]Map:  39%|███▉      | 19556/50002 [00:16<00:22, 1335.18 examples/s]Map:  39%|███▉      | 19702/50002 [00:16<00:22, 1367.85 examples/s]Map:  40%|███▉      | 19841/50002 [00:16<00:21, 1373.04 examples/s]Map:  40%|███▉      | 20000/50002 [00:16<00:23, 1252.56 examples/s]Map:  40%|████      | 20134/50002 [00:16<00:23, 1274.95 examples/s]Map:  41%|████      | 20337/50002 [00:16<00:22, 1299.26 examples/s]Map:  41%|████      | 20473/50002 [00:16<00:22, 1309.31 examples/s]Map:  41%|████      | 20619/50002 [00:16<00:21, 1346.42 examples/s]Map:  42%|████▏     | 20758/50002 [00:17<00:21, 1353.58 examples/s]Map:  42%|████▏     | 20952/50002 [00:17<00:22, 1316.48 examples/s]Map:  42%|████▏     | 21126/50002 [00:17<00:26, 1084.22 examples/s]Map:  43%|████▎     | 21268/50002 [00:17<00:24, 1156.50 examples/s]Map:  43%|████▎     | 21405/50002 [00:17<00:23, 1205.15 examples/s]Map:  43%|████▎     | 21568/50002 [00:17<00:24, 1161.02 examples/s]Map:  43%|████▎     | 21745/50002 [00:17<00:24, 1165.58 examples/s]Map:  44%|████▍     | 21881/50002 [00:18<00:23, 1210.29 examples/s]Map:  44%|████▍     | 22069/50002 [00:18<00:24, 1159.96 examples/s]Map:  44%|████▍     | 22208/50002 [00:18<00:22, 1212.48 examples/s]Map:  45%|████▍     | 22348/50002 [00:18<00:21, 1257.16 examples/s]Map:  45%|████▍     | 22491/50002 [00:18<00:21, 1301.48 examples/s]Map:  45%|████▌     | 22628/50002 [00:18<00:20, 1319.44 examples/s]Map:  46%|████▌     | 22827/50002 [00:18<00:20, 1318.96 examples/s]Map:  46%|████▌     | 22965/50002 [00:18<00:20, 1330.25 examples/s]Map:  46%|████▋     | 23144/50002 [00:19<00:21, 1251.48 examples/s]Map:  47%|████▋     | 23287/50002 [00:19<00:20, 1292.30 examples/s]Map:  47%|████▋     | 23424/50002 [00:19<00:20, 1308.71 examples/s]Map:  47%|████▋     | 23565/50002 [00:19<00:19, 1334.17 examples/s]Map:  47%|████▋     | 23706/50002 [00:19<00:19, 1353.45 examples/s]Map:  48%|████▊     | 23903/50002 [00:19<00:19, 1331.61 examples/s]Map:  48%|████▊     | 24064/50002 [00:19<00:21, 1226.14 examples/s]Map:  48%|████▊     | 24203/50002 [00:19<00:20, 1263.92 examples/s]Map:  49%|████▊     | 24346/50002 [00:19<00:19, 1304.88 examples/s]Map:  49%|████▉     | 24543/50002 [00:20<00:19, 1305.30 examples/s]Map:  49%|████▉     | 24683/50002 [00:20<00:19, 1327.46 examples/s]Map:  50%|████▉     | 24880/50002 [00:20<00:19, 1320.41 examples/s]Map:  50%|█████     | 25065/50002 [00:20<00:20, 1221.09 examples/s]Map:  50%|█████     | 25208/50002 [00:20<00:19, 1267.85 examples/s]Map:  51%|█████     | 25352/50002 [00:20<00:18, 1309.21 examples/s]Map:  51%|█████     | 25492/50002 [00:20<00:18, 1327.74 examples/s]Map:  51%|█████▏    | 25691/50002 [00:20<00:18, 1324.16 examples/s]Map:  52%|█████▏    | 25892/50002 [00:21<00:18, 1320.81 examples/s]Map:  52%|█████▏    | 26062/50002 [00:21<00:19, 1231.45 examples/s]Map:  52%|█████▏    | 26200/50002 [00:21<00:18, 1261.38 examples/s]Map:  53%|█████▎    | 26339/50002 [00:21<00:18, 1291.65 examples/s]Map:  53%|█████▎    | 26478/50002 [00:21<00:17, 1316.25 examples/s]Map:  53%|█████▎    | 26623/50002 [00:21<00:17, 1347.83 examples/s]Map:  54%|█████▎    | 26827/50002 [00:21<00:17, 1349.70 examples/s]Map:  54%|█████▍    | 27000/50002 [00:22<00:18, 1255.32 examples/s]Map:  54%|█████▍    | 27142/50002 [00:22<00:17, 1293.32 examples/s]Map:  55%|█████▍    | 27280/50002 [00:22<00:17, 1311.16 examples/s]Map:  55%|█████▍    | 27419/50002 [00:22<00:17, 1328.37 examples/s]Map:  55%|█████▌    | 27615/50002 [00:22<00:16, 1316.99 examples/s]Map:  55%|█████▌    | 27751/50002 [00:22<00:16, 1325.67 examples/s]Map:  56%|█████▌    | 27896/50002 [00:22<00:16, 1356.44 examples/s]Map:  56%|█████▌    | 28071/50002 [00:22<00:17, 1241.71 examples/s]Map:  56%|█████▋    | 28217/50002 [00:22<00:16, 1295.19 examples/s]Map:  57%|█████▋    | 28359/50002 [00:23<00:16, 1325.38 examples/s]Map:  57%|█████▋    | 28502/50002 [00:23<00:15, 1351.68 examples/s]Map:  57%|█████▋    | 28644/50002 [00:23<00:15, 1370.08 examples/s]Map:  58%|█████▊    | 28849/50002 [00:23<00:15, 1362.26 examples/s]Map:  58%|█████▊    | 28987/50002 [00:23<00:15, 1365.37 examples/s]Map:  58%|█████▊    | 29153/50002 [00:23<00:16, 1271.47 examples/s]Map:  59%|█████▊    | 29341/50002 [00:23<00:16, 1263.17 examples/s]Map:  59%|█████▉    | 29476/50002 [00:23<00:15, 1283.46 examples/s]Map:  59%|█████▉    | 29614/50002 [00:23<00:15, 1305.38 examples/s]Map:  60%|█████▉    | 29812/50002 [00:24<00:15, 1307.87 examples/s]Map:  60%|█████▉    | 29954/50002 [00:24<00:15, 1334.02 examples/s]Map:  60%|██████    | 30131/50002 [00:24<00:16, 1234.63 examples/s]Map:  61%|██████    | 30263/50002 [00:24<00:15, 1247.07 examples/s]Map:  61%|██████    | 30400/50002 [00:24<00:15, 1276.88 examples/s]Map:  61%|██████    | 30541/50002 [00:24<00:14, 1310.00 examples/s]Map:  61%|██████▏   | 30676/50002 [00:24<00:14, 1317.88 examples/s]Map:  62%|██████▏   | 30875/50002 [00:24<00:14, 1318.19 examples/s]Map:  62%|██████▏   | 31062/50002 [00:25<00:15, 1209.80 examples/s]Map:  62%|██████▏   | 31200/50002 [00:25<00:15, 1246.57 examples/s]Map:  63%|██████▎   | 31340/50002 [00:25<00:14, 1283.31 examples/s]Map:  63%|██████▎   | 31473/50002 [00:25<00:14, 1294.04 examples/s]Map:  63%|██████▎   | 31609/50002 [00:25<00:14, 1308.02 examples/s]Map:  63%|██████▎   | 31743/50002 [00:25<00:13, 1314.08 examples/s]Map:  64%|██████▎   | 31876/50002 [00:25<00:13, 1314.99 examples/s]Map:  64%|██████▍   | 32016/50002 [00:25<00:15, 1166.88 examples/s]Map:  64%|██████▍   | 32152/50002 [00:26<00:14, 1217.18 examples/s]Map:  65%|██████▍   | 32341/50002 [00:26<00:14, 1229.64 examples/s]Map:  65%|██████▍   | 32499/50002 [00:26<00:15, 1165.46 examples/s]Map:  65%|██████▌   | 32642/50002 [00:26<00:14, 1225.30 examples/s]Map:  66%|██████▌   | 32773/50002 [00:26<00:13, 1245.60 examples/s]Map:  66%|██████▌   | 32908/50002 [00:26<00:13, 1272.14 examples/s]Map:  66%|██████▌   | 33042/50002 [00:26<00:16, 1045.03 examples/s]Map:  66%|██████▋   | 33188/50002 [00:26<00:16, 1014.96 examples/s]Map:  67%|██████▋   | 33328/50002 [00:27<00:16, 985.39 examples/s] Map:  67%|██████▋   | 33446/50002 [00:27<00:16, 1027.66 examples/s]Map:  67%|██████▋   | 33559/50002 [00:27<00:15, 1049.03 examples/s]Map:  67%|██████▋   | 33679/50002 [00:27<00:15, 1084.89 examples/s]Map:  68%|██████▊   | 33795/50002 [00:27<00:14, 1103.52 examples/s]Map:  68%|██████▊   | 33913/50002 [00:27<00:14, 1123.06 examples/s]Map:  68%|██████▊   | 34055/50002 [00:27<00:15, 1028.46 examples/s]Map:  68%|██████▊   | 34167/50002 [00:27<00:15, 1050.06 examples/s]Map:  69%|██████▊   | 34285/50002 [00:27<00:14, 1081.43 examples/s]Map:  69%|██████▉   | 34399/50002 [00:28<00:14, 1096.84 examples/s]Map:  69%|██████▉   | 34514/50002 [00:28<00:13, 1110.42 examples/s]Map:  69%|██████▉   | 34630/50002 [00:28<00:13, 1120.63 examples/s]Map:  70%|██████▉   | 34800/50002 [00:28<00:13, 1123.29 examples/s]Map:  70%|██████▉   | 34969/50002 [00:28<00:13, 1123.21 examples/s]Map:  70%|███████   | 35111/50002 [00:28<00:14, 1024.09 examples/s]Map:  70%|███████   | 35224/50002 [00:28<00:14, 1047.49 examples/s]Map:  71%|███████   | 35378/50002 [00:28<00:14, 1034.58 examples/s]Map:  71%|███████   | 35536/50002 [00:29<00:13, 1033.88 examples/s]Map:  71%|███████▏  | 35695/50002 [00:29<00:13, 1036.64 examples/s]Map:  72%|███████▏  | 35808/50002 [00:29<00:13, 1054.55 examples/s]Map:  72%|███████▏  | 35923/50002 [00:29<00:13, 1074.55 examples/s]Map:  72%|███████▏  | 36054/50002 [00:29<00:14, 983.26 examples/s] Map:  72%|███████▏  | 36161/50002 [00:29<00:13, 1000.41 examples/s]Map:  73%|███████▎  | 36308/50002 [00:29<00:13, 987.77 examples/s] Map:  73%|███████▎  | 36460/50002 [00:30<00:13, 993.19 examples/s]Map:  73%|███████▎  | 36563/50002 [00:30<00:13, 1000.61 examples/s]Map:  73%|███████▎  | 36677/50002 [00:30<00:12, 1031.91 examples/s]Map:  74%|███████▎  | 36818/50002 [00:30<00:13, 998.34 examples/s] Map:  74%|███████▍  | 36926/50002 [00:30<00:12, 1017.74 examples/s]Map:  74%|███████▍  | 37062/50002 [00:30<00:13, 928.85 examples/s] Map:  74%|███████▍  | 37211/50002 [00:30<00:13, 942.53 examples/s]Map:  75%|███████▍  | 37324/50002 [00:30<00:12, 984.88 examples/s]Map:  75%|███████▍  | 37440/50002 [00:31<00:12, 1027.96 examples/s]Map:  75%|███████▌  | 37552/50002 [00:31<00:11, 1047.12 examples/s]Map:  75%|███████▌  | 37665/50002 [00:31<00:11, 1068.51 examples/s]Map:  76%|███████▌  | 37774/50002 [00:31<00:11, 1071.41 examples/s]Map:  76%|███████▌  | 37886/50002 [00:31<00:11, 1082.05 examples/s]Map:  76%|███████▌  | 38000/50002 [00:31<00:12, 989.58 examples/s] Map:  76%|███████▌  | 38106/50002 [00:31<00:11, 1005.62 examples/s]Map:  76%|███████▋  | 38219/50002 [00:31<00:11, 1037.35 examples/s]Map:  77%|███████▋  | 38336/50002 [00:31<00:10, 1071.04 examples/s]Map:  77%|███████▋  | 38448/50002 [00:31<00:10, 1083.95 examples/s]Map:  77%|███████▋  | 38564/50002 [00:32<00:10, 1104.55 examples/s]Map:  77%|███████▋  | 38683/50002 [00:32<00:10, 1127.35 examples/s]Map:  78%|███████▊  | 38849/50002 [00:32<00:10, 1113.25 examples/s]Map:  78%|███████▊  | 38965/50002 [00:32<00:09, 1117.47 examples/s]Map:  78%|███████▊  | 39108/50002 [00:32<00:10, 1006.19 examples/s]Map:  78%|███████▊  | 39222/50002 [00:32<00:10, 1034.95 examples/s]Map:  79%|███████▊  | 39341/50002 [00:32<00:09, 1073.05 examples/s]Map:  79%|███████▉  | 39451/50002 [00:32<00:09, 1078.57 examples/s]Map:  79%|███████▉  | 39571/50002 [00:33<00:09, 1109.30 examples/s]Map:  79%|███████▉  | 39694/50002 [00:33<00:09, 1140.09 examples/s]Map:  80%|███████▉  | 39813/50002 [00:33<00:08, 1151.96 examples/s]Map:  80%|███████▉  | 39931/50002 [00:33<00:08, 1159.31 examples/s]Map:  80%|████████  | 40063/50002 [00:33<00:09, 1048.72 examples/s]Map:  80%|████████  | 40173/50002 [00:33<00:09, 1058.39 examples/s]Map:  81%|████████  | 40284/50002 [00:33<00:09, 1068.99 examples/s]Map:  81%|████████  | 40397/50002 [00:33<00:08, 1083.98 examples/s]Map:  81%|████████  | 40510/50002 [00:33<00:08, 1094.68 examples/s]Map:  81%|████████  | 40622/50002 [00:33<00:08, 1099.61 examples/s]Map:  81%|████████▏ | 40737/50002 [00:34<00:08, 1109.94 examples/s]Map:  82%|████████▏ | 40853/50002 [00:34<00:08, 1123.32 examples/s]Map:  82%|████████▏ | 40967/50002 [00:34<00:08, 1126.71 examples/s]Map:  82%|████████▏ | 41124/50002 [00:34<00:08, 1043.81 examples/s]Map:  82%|████████▏ | 41235/50002 [00:34<00:08, 1056.61 examples/s]Map:  83%|████████▎ | 41357/50002 [00:34<00:07, 1099.16 examples/s]Map:  83%|████████▎ | 41473/50002 [00:34<00:07, 1111.86 examples/s]Map:  83%|████████▎ | 41648/50002 [00:34<00:07, 1128.14 examples/s]Map:  84%|████████▎ | 41821/50002 [00:35<00:07, 1131.87 examples/s]Map:  84%|████████▍ | 41935/50002 [00:35<00:07, 1132.60 examples/s]Map:  84%|████████▍ | 42059/50002 [00:35<00:07, 1024.12 examples/s]Map:  84%|████████▍ | 42171/50002 [00:35<00:07, 1043.51 examples/s]Map:  85%|████████▍ | 42286/50002 [00:35<00:07, 1068.20 examples/s]Map:  85%|████████▍ | 42398/50002 [00:35<00:07, 1077.10 examples/s]Map:  85%|████████▌ | 42520/50002 [00:35<00:06, 1113.34 examples/s]Map:  85%|████████▌ | 42639/50002 [00:35<00:06, 1130.34 examples/s]Map:  86%|████████▌ | 42758/50002 [00:35<00:06, 1143.41 examples/s]Map:  86%|████████▌ | 42937/50002 [00:36<00:06, 1158.82 examples/s]Map:  86%|████████▌ | 43067/50002 [00:36<00:06, 1053.53 examples/s]Map:  86%|████████▋ | 43212/50002 [00:36<00:05, 1150.70 examples/s]Map:  87%|████████▋ | 43357/50002 [00:36<00:05, 1228.32 examples/s]Map:  87%|████████▋ | 43491/50002 [00:36<00:05, 1256.87 examples/s]Map:  87%|████████▋ | 43634/50002 [00:36<00:04, 1302.34 examples/s]Map:  88%|████████▊ | 43841/50002 [00:36<00:04, 1321.80 examples/s]Map:  88%|████████▊ | 43985/50002 [00:36<00:04, 1346.61 examples/s]Map:  88%|████████▊ | 44147/50002 [00:37<00:04, 1247.54 examples/s]Map:  89%|████████▊ | 44279/50002 [00:37<00:04, 1264.66 examples/s]Map:  89%|████████▉ | 44415/50002 [00:37<00:04, 1285.54 examples/s]Map:  89%|████████▉ | 44555/50002 [00:37<00:04, 1313.74 examples/s]Map:  90%|████████▉ | 44759/50002 [00:37<00:03, 1326.84 examples/s]Map:  90%|████████▉ | 44957/50002 [00:37<00:03, 1321.63 examples/s]Map:  90%|█████████ | 45139/50002 [00:37<00:03, 1246.80 examples/s]Map:  91%|█████████ | 45270/50002 [00:37<00:03, 1258.55 examples/s]Map:  91%|█████████ | 45411/50002 [00:38<00:03, 1294.33 examples/s]Map:  91%|█████████ | 45553/50002 [00:38<00:03, 1323.74 examples/s]Map:  91%|█████████▏| 45691/50002 [00:38<00:03, 1337.08 examples/s]Map:  92%|█████████▏| 45830/50002 [00:38<00:03, 1348.77 examples/s]Map:  92%|█████████▏| 45966/50002 [00:38<00:02, 1349.79 examples/s]Map:  92%|█████████▏| 46128/50002 [00:38<00:03, 1228.13 examples/s]Map:  93%|█████████▎| 46272/50002 [00:38<00:02, 1280.77 examples/s]Map:  93%|█████████▎| 46407/50002 [00:38<00:02, 1297.81 examples/s]Map:  93%|█████████▎| 46545/50002 [00:38<00:02, 1319.00 examples/s]Map:  93%|█████████▎| 46746/50002 [00:39<00:02, 1323.35 examples/s]Map:  94%|█████████▍| 46890/50002 [00:39<00:02, 1347.03 examples/s]Map:  94%|█████████▍| 47069/50002 [00:39<00:02, 1271.33 examples/s]Map:  94%|█████████▍| 47214/50002 [00:39<00:02, 1311.98 examples/s]Map:  95%|█████████▍| 47358/50002 [00:39<00:01, 1344.56 examples/s]Map:  95%|█████████▍| 47499/50002 [00:39<00:01, 1359.88 examples/s]Map:  95%|█████████▌| 47705/50002 [00:39<00:01, 1358.65 examples/s]Map:  96%|█████████▌| 47844/50002 [00:39<00:01, 1363.59 examples/s]Map:  96%|█████████▌| 48000/50002 [00:39<00:01, 1242.57 examples/s]Map:  96%|█████████▋| 48129/50002 [00:40<00:01, 1253.34 examples/s]Map:  97%|█████████▋| 48274/50002 [00:40<00:01, 1302.40 examples/s]Map:  97%|█████████▋| 48472/50002 [00:40<00:01, 1301.11 examples/s]Map:  97%|█████████▋| 48614/50002 [00:40<00:01, 1330.61 examples/s]Map:  98%|█████████▊| 48758/50002 [00:40<00:00, 1356.56 examples/s]Map:  98%|█████████▊| 48900/50002 [00:40<00:00, 1366.89 examples/s]Map:  98%|█████████▊| 49065/50002 [00:40<00:00, 1254.00 examples/s]Map:  98%|█████████▊| 49206/50002 [00:40<00:00, 1293.45 examples/s]Map:  99%|█████████▉| 49398/50002 [00:41<00:00, 1285.67 examples/s]Map:  99%|█████████▉| 49530/50002 [00:41<00:00, 1292.16 examples/s]Map:  99%|█████████▉| 49667/50002 [00:41<00:00, 1310.12 examples/s]Map: 100%|█████████▉| 49803/50002 [00:41<00:00, 1320.68 examples/s]Map: 100%|█████████▉| 49941/50002 [00:41<00:00, 1332.73 examples/s]                                                                   Map:   0%|          | 0/2000 [00:00<?, ? examples/s]Map:   7%|▋         | 136/2000 [00:00<00:01, 1334.55 examples/s]Map:  17%|█▋        | 334/2000 [00:00<00:01, 1316.10 examples/s]Map:  24%|██▎       | 470/2000 [00:00<00:01, 1330.56 examples/s]Map:  31%|███       | 616/2000 [00:00<00:01, 1372.59 examples/s]Map:  41%|████▏     | 825/2000 [00:00<00:00, 1377.04 examples/s]Map:  48%|████▊     | 969/2000 [00:00<00:00, 1391.78 examples/s]Map:  57%|█████▋    | 1135/2000 [00:00<00:00, 1259.42 examples/s]Map:  64%|██████▍   | 1278/2000 [00:00<00:00, 1301.56 examples/s]Map:  71%|███████   | 1413/2000 [00:01<00:00, 1310.37 examples/s]Map:  78%|███████▊  | 1560/2000 [00:01<00:00, 1351.32 examples/s]Map:  85%|████████▌ | 1706/2000 [00:01<00:00, 1381.40 examples/s]Map:  93%|█████████▎| 1855/2000 [00:01<00:00, 1408.64 examples/s]Map: 100%|██████████| 2000/2000 [00:01<00:00, 1276.53 examples/s]                                                                 wandb: Currently logged in as: xiaoce-gao (nascentcore). Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.15.2
wandb: Run data is saved locally in /home/tricorder/test/gxc/alpaca_lora_env/alpaca-lora/wandb/run-20230514_000507-lhp4mns5
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run  
wandb: ⭐️ View project at https://wandb.ai/nascentcore/llama_test_project
wandb: 🚀 View run at https://wandb.ai/nascentcore/llama_test_project/runs/lhp4mns5
  0%|          | 0/144 [00:00<?, ?it/s]/home/tricorder/yang/anaconda3/envs/llama_alpaca_lora/lib/python3.10/site-packages/bitsandbytes/autograd/_functions.py:318: UserWarning: MatMul8bitLt: inputs will be cast from torch.float32 to float16 during quantization
  warnings.warn(f"MatMul8bitLt: inputs will be cast from {A.dtype} to float16 during quantization")
  1%|          | 1/144 [11:03<26:21:23, 663.52s/it]  1%|▏         | 2/144 [20:10<23:27:29, 594.71s/it]  2%|▏         | 3/144 [28:45<21:52:02, 558.31s/it]  3%|▎         | 4/144 [37:03<20:47:31, 534.65s/it]  3%|▎         | 5/144 [45:03<19:52:58, 514.95s/it]  4%|▍         | 6/144 [52:39<18:58:27, 494.98s/it]  5%|▍         | 7/144 [1:00:02<18:11:16, 477.93s/it]  6%|▌         | 8/144 [1:07:25<17:37:50, 466.69s/it]  6%|▋         | 9/144 [1:14:27<16:58:55, 452.86s/it]  7%|▋         | 10/144 [1:21:15<16:20:12, 438.90s/it]                                                        7%|▋         | 10/144 [1:21:15<16:20:12, 438.90s/it]  8%|▊         | 11/144 [1:28:08<15:55:50, 431.21s/it]  8%|▊         | 12/144 [1:34:38<15:21:03, 418.66s/it]  9%|▉         | 13/144 [1:45:42<17:56:14, 492.93s/it] 10%|▉         | 14/144 [1:54:52<18:25:10, 510.08s/it] 10%|█         | 15/144 [2:03:34<18:24:11, 513.58s/it] 11%|█         | 16/144 [2:11:46<18:02:05, 507.23s/it] 12%|█▏        | 17/144 [2:19:43<17:34:07, 498.01s/it] 12%|█▎        | 18/144 [2:27:18<16:59:07, 485.29s/it] 13%|█▎        | 19/144 [2:34:51<16:30:22, 475.38s/it] 14%|█▍        | 20/144 [2:40:25<14:54:40, 432.91s/it]                                                       14%|█▍        | 20/144 [2:40:25<14:54:40, 432.91s/it] 15%|█▍        | 21/144 [2:45:41<13:35:31, 397.82s/it] 15%|█▌        | 22/144 [2:50:46<12:32:23, 370.03s/it] 16%|█▌        | 23/144 [2:55:50<11:46:21, 350.26s/it] 17%|█▋        | 24/144 [3:00:44<11:06:39, 333.33s/it] 17%|█▋        | 25/144 [3:09:18<12:48:35, 387.52s/it] 18%|█▊        | 26/144 [3:16:17<13:00:35, 396.92s/it] 19%|█▉        | 27/144 [3:22:50<12:52:11, 396.00s/it] 19%|█▉        | 28/144 [3:28:56<12:28:11, 387.00s/it] 20%|██        | 29/144 [3:34:57<12:06:15, 378.92s/it] 21%|██        | 30/144 [3:40:37<11:38:11, 367.47s/it]                                                       21%|██        | 30/144 [3:40:37<11:38:11, 367.47s/it] 22%|██▏       | 31/144 [3:46:07<11:10:29, 356.01s/it] 22%|██▏       | 32/144 [3:51:29<10:45:57, 346.05s/it] 23%|██▎       | 33/144 [3:56:43<10:22:06, 336.27s/it] 24%|██▎       | 34/144 [4:01:49<9:59:53, 327.21s/it]  24%|██▍       | 35/144 [4:06:46<9:38:11, 318.27s/it] 25%|██▌       | 36/144 [4:11:34<9:16:26, 309.13s/it] 26%|██▌       | 37/144 [4:20:18<11:06:00, 373.46s/it] 26%|██▋       | 38/144 [4:26:03<10:44:55, 365.05s/it] 27%|██▋       | 39/144 [4:31:07<10:06:36, 346.64s/it] 28%|██▊       | 40/144 [4:35:58<9:31:47, 329.88s/it]                                                       28%|██▊       | 40/144 [4:35:58<9:31:47, 329.88s/it] 28%|██▊       | 41/144 [4:40:36<8:59:59, 314.56s/it] 29%|██▉       | 42/144 [4:45:00<8:28:34, 299.16s/it] 30%|██▉       | 43/144 [4:49:22<8:05:15, 288.28s/it] 31%|███       | 44/144 [4:53:28<7:38:50, 275.30s/it] 31%|███▏      | 45/144 [4:57:29<7:17:25, 265.11s/it] 32%|███▏      | 46/144 [5:01:15<6:53:51, 253.38s/it] 33%|███▎      | 47/144 [5:05:04<6:37:44, 246.03s/it] 33%|███▎      | 48/144 [5:08:42<6:20:06, 237.57s/it] 34%|███▍      | 49/144 [5:14:05<6:56:43, 263.19s/it] 35%|███▍      | 50/144 [5:20:25<7:47:17, 298.27s/it]                                                      35%|███▍      | 50/144 [5:20:25<7:47:17, 298.27s/it] 35%|███▌      | 51/144 [5:25:54<7:56:43, 307.57s/it] 36%|███▌      | 52/144 [5:30:55<7:48:39, 305.65s/it] 37%|███▋      | 53/144 [5:35:39<7:33:51, 299.24s/it] 38%|███▊      | 54/144 [5:40:20<7:20:34, 293.71s/it] 38%|███▊      | 55/144 [5:44:50<7:05:02, 286.55s/it] 39%|███▉      | 56/144 [5:49:16<6:51:18, 280.44s/it] 40%|███▉      | 57/144 [5:53:36<6:37:36, 274.22s/it] 40%|████      | 58/144 [5:58:59<6:54:16, 289.03s/it] 41%|████      | 59/144 [6:03:23<6:38:24, 281.23s/it] 42%|████▏     | 60/144 [6:07:11<6:11:45, 265.54s/it]                                                      42%|████▏     | 60/144 [6:07:11<6:11:45, 265.54s/it] 42%|████▏     | 61/144 [6:11:49<6:12:12, 269.07s/it] 43%|████▎     | 62/144 [6:18:11<6:54:19, 303.16s/it] 44%|████▍     | 63/144 [6:24:02<7:08:15, 317.23s/it] 44%|████▍     | 64/144 [6:30:08<7:22:35, 331.95s/it] 45%|████▌     | 65/144 [6:35:34<7:14:54, 330.31s/it] 46%|████▌     | 66/144 [6:41:06<7:09:53, 330.69s/it] 47%|████▋     | 67/144 [6:45:39<6:42:21, 313.52s/it] 47%|████▋     | 68/144 [6:50:28<6:27:35, 305.99s/it] 48%|████▊     | 69/144 [6:56:29<6:43:02, 322.43s/it] 49%|████▊     | 70/144 [7:02:18<6:47:43, 330.59s/it]                                                      49%|████▊     | 70/144 [7:02:18<6:47:43, 330.59s/it] 49%|████▉     | 71/144 [7:08:04<6:47:37, 335.04s/it] 50%|█████     | 72/144 [7:13:34<6:40:27, 333.72s/it] 51%|█████     | 73/144 [7:20:06<6:55:32, 351.16s/it] 51%|█████▏    | 74/144 [7:28:53<7:51:17, 403.96s/it] 52%|█████▏    | 75/144 [7:36:36<8:04:48, 421.58s/it] 53%|█████▎    | 76/144 [7:43:51<8:02:27, 425.70s/it] 53%|█████▎    | 77/144 [7:50:50<7:53:05, 423.67s/it] 54%|█████▍    | 78/144 [7:57:23<7:36:00, 414.55s/it] 55%|█████▍    | 79/144 [8:03:38<7:16:00, 402.48s/it] 56%|█████▌    | 80/144 [8:09:37<6:55:26, 389.48s/it]                                                      56%|█████▌    | 80/144 [8:09:37<6:55:26, 389.48s/it] 56%|█████▋    | 81/144 [8:14:49<6:24:34, 366.27s/it] 57%|█████▋    | 82/144 [8:18:51<5:40:02, 329.07s/it] 58%|█████▊    | 83/144 [8:22:51<5:07:18, 302.27s/it] 58%|█████▊    | 84/144 [8:26:41<4:40:31, 280.53s/it] 59%|█████▉    | 85/144 [8:31:21<4:35:52, 280.56s/it] 60%|█████▉    | 86/144 [8:37:46<5:01:20, 311.73s/it] 60%|██████    | 87/144 [8:43:09<4:59:15, 315.01s/it] 61%|██████    | 88/144 [8:48:10<4:50:03, 310.78s/it] 62%|██████▏   | 89/144 [8:53:00<4:39:16, 304.66s/it] 62%|██████▎   | 90/144 [8:57:40<4:27:35, 297.33s/it]                                                      62%|██████▎   | 90/144 [8:57:40<4:27:35, 297.33s/it] 63%|██████▎   | 91/144 [9:02:10<4:15:23, 289.12s/it] 64%|██████▍   | 92/144 [9:06:25<4:01:33, 278.73s/it] 65%|██████▍   | 93/144 [9:10:35<3:49:42, 270.24s/it] 65%|██████▌   | 94/144 [9:14:44<3:39:55, 263.90s/it] 66%|██████▌   | 95/144 [9:18:41<3:28:47, 255.66s/it] 67%|██████▋   | 96/144 [9:22:34<3:19:12, 249.02s/it] 67%|██████▋   | 97/144 [9:26:33<3:12:46, 246.10s/it] 68%|██████▊   | 98/144 [9:32:18<3:31:13, 275.52s/it] 69%|██████▉   | 99/144 [9:38:20<3:46:07, 301.49s/it] 69%|██████▉   | 100/144 [9:43:38<3:44:44, 306.46s/it]                                                       69%|██████▉   | 100/144 [9:43:38<3:44:44, 306.46s/it] 70%|███████   | 101/144 [9:48:33<3:37:12, 303.07s/it] 71%|███████   | 102/144 [9:53:19<3:28:30, 297.88s/it] 72%|███████▏  | 103/144 [9:57:51<3:18:20, 290.26s/it] 72%|███████▏  | 104/144 [10:02:12<3:07:44, 281.61s/it] 73%|███████▎  | 105/144 [10:06:22<2:56:44, 271.92s/it] 74%|███████▎  | 106/144 [10:10:15<2:44:48, 260.23s/it] 74%|███████▍  | 107/144 [10:14:15<2:36:42, 254.13s/it] 75%|███████▌  | 108/144 [10:18:03<2:27:54, 246.51s/it] 76%|███████▌  | 109/144 [10:21:43<2:19:08, 238.52s/it] 76%|███████▋  | 110/144 [10:26:53<2:27:16, 259.89s/it]                                                        76%|███████▋  | 110/144 [10:26:53<2:27:16, 259.89s/it] 77%|███████▋  | 111/144 [10:32:56<2:40:01, 290.94s/it] 78%|███████▊  | 112/144 [10:38:16<2:39:41, 299.41s/it] 78%|███████▊  | 113/144 [10:43:07<2:33:30, 297.11s/it] 79%|███████▉  | 114/144 [10:47:53<2:26:52, 293.76s/it] 80%|███████▉  | 115/144 [10:52:23<2:18:33, 286.68s/it] 81%|████████  | 116/144 [10:56:45<2:10:14, 279.10s/it] 81%|████████▏ | 117/144 [11:00:59<2:02:09, 271.47s/it] 82%|████████▏ | 118/144 [11:05:05<1:54:24, 264.01s/it] 83%|████████▎ | 119/144 [11:09:11<1:47:47, 258.69s/it] 83%|████████▎ | 120/144 [11:12:59<1:39:44, 249.35s/it]                                                        83%|████████▎ | 120/144 [11:12:59<1:39:44, 249.35s/it] 84%|████████▍ | 121/144 [11:16:38<1:32:07, 240.32s/it] 85%|████████▍ | 122/144 [11:22:09<1:38:02, 267.37s/it] 85%|████████▌ | 123/144 [11:28:13<1:43:47, 296.52s/it] 86%|████████▌ | 124/144 [11:33:40<1:41:54, 305.74s/it] 87%|████████▋ | 125/144 [11:38:38<1:36:04, 303.41s/it] 88%|████████▊ | 126/144 [11:43:27<1:29:40, 298.92s/it] 88%|████████▊ | 127/144 [11:47:56<1:22:08, 289.89s/it] 89%|████████▉ | 128/144 [11:52:16<1:14:55, 280.99s/it] 90%|████████▉ | 129/144 [11:56:27<1:08:00, 272.05s/it] 90%|█████████ | 130/144 [12:00:33<1:01:38, 264.19s/it]                                                        90%|█████████ | 130/144 [12:00:33<1:01:38, 264.19s/it] 91%|█████████ | 131/144 [12:04:25<55:07, 254.40s/it]   92%|█████████▏| 132/144 [12:08:12<49:15, 246.32s/it] 92%|█████████▏| 133/144 [12:11:58<44:02, 240.26s/it] 93%|█████████▎| 134/144 [12:17:00<43:08, 258.87s/it] 94%|█████████▍| 135/144 [12:23:00<43:22, 289.20s/it] 94%|█████████▍| 136/144 [12:28:17<39:38, 297.29s/it] 95%|█████████▌| 137/144 [12:33:20<34:54, 299.23s/it] 96%|█████████▌| 138/144 [12:38:04<29:28, 294.70s/it] 97%|█████████▋| 139/144 [12:42:33<23:54, 286.84s/it] 97%|█████████▋| 140/144 [12:46:56<18:39, 279.76s/it]                                                      97%|█████████▋| 140/144 [12:46:56<18:39, 279.76s/it] 98%|█████████▊| 141/144 [12:51:05<13:31, 270.35s/it] 99%|█████████▊| 142/144 [12:55:07<08:43, 261.85s/it] 99%|█████████▉| 143/144 [12:58:57<04:12, 252.48s/it]100%|██████████| 144/144 [13:02:48<00:00, 246.08s/it]                                                     100%|██████████| 144/144 [13:02:48<00:00, 246.08s/it]100%|██████████| 144/144 [13:02:48<00:00, 326.17s/it]
ERROR: Could not consume arg:  
Usage: finetune.py ' ' ' ' --base_model /home/tricorder/test/gxc/decapoda-research/llama-7b-hf ' ' ' ' --data_path ../data/alpaca_data.json ' ' ' ' --output_dir ../lora_alpaca_output_free/source_2048 ' ' ' ' --batch_size 1024 ' ' ' ' --micro_batch_size 4 ' ' ' ' --num_epochs 3 ' ' ' ' --learning_rate 2e-5 ' ' ' ' --cutoff_len 512 ' ' ' ' --val_set_size 2000 ' ' ' ' --lora_r

For detailed information on this command, run:
  finetune.py ' ' ' ' --base_model /home/tricorder/test/gxc/decapoda-research/llama-7b-hf ' ' ' ' --data_path ../data/alpaca_data.json ' ' ' ' --output_dir ../lora_alpaca_output_free/source_2048 ' ' ' ' --batch_size 1024 ' ' ' ' --micro_batch_size 4 ' ' ' ' --num_epochs 3 ' ' ' ' --learning_rate 2e-5 ' ' ' ' --cutoff_len 512 ' ' ' ' --val_set_size 2000 ' ' ' ' --lora_r --help
{'loss': 2.3268, 'learning_rate': 2.0000000000000003e-06, 'epoch': 0.2}
{'loss': 2.3659, 'learning_rate': 4.000000000000001e-06, 'epoch': 0.41}
{'loss': 2.3904, 'learning_rate': 6e-06, 'epoch': 0.61}
{'loss': 2.4157, 'learning_rate': 8.000000000000001e-06, 'epoch': 0.82}
{'loss': 2.4425, 'learning_rate': 1e-05, 'epoch': 1.02}
{'loss': 2.2907, 'learning_rate': 1.2e-05, 'epoch': 1.23}
{'loss': 2.1363, 'learning_rate': 1.4e-05, 'epoch': 1.43}
{'loss': 2.0669, 'learning_rate': 1.6000000000000003e-05, 'epoch': 1.64}
{'loss': 1.9482, 'learning_rate': 1.8e-05, 'epoch': 1.84}
{'loss': 1.7354, 'learning_rate': 2e-05, 'epoch': 2.05}
{'loss': 1.4567, 'learning_rate': 1.5454545454545454e-05, 'epoch': 2.25}
{'loss': 1.3322, 'learning_rate': 1.0909090909090909e-05, 'epoch': 2.46}
{'loss': 1.2837, 'learning_rate': 6.363636363636364e-06, 'epoch': 2.66}
{'loss': 1.2654, 'learning_rate': 1.8181818181818183e-06, 'epoch': 2.87}
{'train_runtime': 46975.5709, 'train_samples_per_second': 3.193, 'train_steps_per_second': 0.003, 'train_loss': 1.9405356844266255, 'epoch': 2.95}

 If there's a warning about missing keys above, please disregard :)
wandb: Waiting for W&B process to finish... (success).
wandb: - 0.011 MB of 0.011 MB uploaded (0.000 MB deduped)wandb: \ 0.011 MB of 0.011 MB uploaded (0.000 MB deduped)wandb: | 0.011 MB of 0.011 MB uploaded (0.000 MB deduped)wandb: / 0.011 MB of 0.011 MB uploaded (0.000 MB deduped)wandb: - 0.011 MB of 0.011 MB uploaded (0.000 MB deduped)wandb: \ 0.011 MB of 0.011 MB uploaded (0.000 MB deduped)wandb: | 0.011 MB of 0.011 MB uploaded (0.000 MB deduped)wandb: / 0.011 MB of 0.011 MB uploaded (0.000 MB deduped)wandb: - 0.011 MB of 0.011 MB uploaded (0.000 MB deduped)wandb: \ 0.011 MB of 0.011 MB uploaded (0.000 MB deduped)wandb: | 0.011 MB of 0.011 MB uploaded (0.000 MB deduped)wandb: / 0.011 MB of 0.011 MB uploaded (0.000 MB deduped)wandb: 
wandb: Run history:
wandb:                    train/epoch ▁▂▂▃▃▄▄▅▅▆▆▇▇██
wandb:              train/global_step ▁▂▂▃▃▄▄▅▅▆▆▇▇██
wandb:            train/learning_rate ▁▂▃▃▄▅▆▆▇█▆▅▃▁
wandb:                     train/loss ▇████▇▆▆▅▄▂▁▁▁
wandb:               train/total_flos ▁
wandb:               train/train_loss ▁
wandb:            train/train_runtime ▁
wandb: train/train_samples_per_second ▁
wandb:   train/train_steps_per_second ▁
wandb: 
wandb: Run summary:
wandb:                    train/epoch 2.95
wandb:              train/global_step 144
wandb:            train/learning_rate 0.0
wandb:                     train/loss 1.2654
wandb:               train/total_flos 7.739948666958643e+17
wandb:               train/train_loss 1.94054
wandb:            train/train_runtime 46975.5709
wandb: train/train_samples_per_second 3.193
wandb:   train/train_steps_per_second 0.003
wandb: 
wandb: 🚀 View run   at: https://wandb.ai/nascentcore/llama_test_project/runs/lhp4mns5
wandb: Synced 6 W&B file(s), 0 media file(s), 2 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20230514_000507-lhp4mns5/logs

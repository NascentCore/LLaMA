/home/tricorder/yang/anaconda3/envs/llama_alpaca_lora/lib/python3.10/site-packages/bitsandbytes/cuda_setup/main.py:145: UserWarning: /home/tricorder/yang/anaconda3/envs/llama_alpaca_lora did not contain ['libcudart.so', 'libcudart.so.11.0', 'libcudart.so.12.0'] as expected! Searching further paths...
  warn(msg)

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please run

python -m bitsandbytes

 and submit this information together with your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
bin /home/tricorder/yang/anaconda3/envs/llama_alpaca_lora/lib/python3.10/site-packages/bitsandbytes/libbitsandbytes_cuda117.so
CUDA SETUP: CUDA runtime path found: /usr/local/cuda-11.7/lib64/libcudart.so
CUDA SETUP: Highest compute capability among GPUs detected: 8.0
CUDA SETUP: Detected CUDA version 117
CUDA SETUP: Loading binary /home/tricorder/yang/anaconda3/envs/llama_alpaca_lora/lib/python3.10/site-packages/bitsandbytes/libbitsandbytes_cuda117.so...
Training Alpaca-LoRA model with params:
base_model: /home/tricorder/test/gxc/decapoda-research/llama-7b-hf
data_path: ../data/alpaca_data.json
output_dir: ../lora_alpaca_output_free
batch_size: 1024
micro_batch_size: 4
num_epochs: 3
learning_rate: 2e-05
cutoff_len: 512
val_set_size: 2000
lora_r: 8
lora_alpha: 16
lora_dropout: 0.05
lora_target_modules: ['q_proj', 'v_proj']
train_on_inputs:  
add_eos_token:  
group_by_length: True
wandb_project: llama_test_project
wandb_run_name:  
wandb_watch: gradients
wandb_log_model:  
resume_from_checkpoint:  
prompt template: alpaca

Loading checkpoint shards:   0%|          | 0/33 [00:00<?, ?it/s]Loading checkpoint shards:   3%|▎         | 1/33 [00:00<00:12,  2.47it/s]Loading checkpoint shards:   6%|▌         | 2/33 [00:00<00:11,  2.68it/s]Loading checkpoint shards:   9%|▉         | 3/33 [00:01<00:10,  2.74it/s]Loading checkpoint shards:  12%|█▏        | 4/33 [00:01<00:10,  2.77it/s]Loading checkpoint shards:  15%|█▌        | 5/33 [00:01<00:10,  2.77it/s]Loading checkpoint shards:  18%|█▊        | 6/33 [00:02<00:09,  2.80it/s]Loading checkpoint shards:  21%|██        | 7/33 [00:02<00:09,  2.80it/s]Loading checkpoint shards:  24%|██▍       | 8/33 [00:02<00:08,  2.81it/s]Loading checkpoint shards:  27%|██▋       | 9/33 [00:03<00:08,  2.79it/s]Loading checkpoint shards:  30%|███       | 10/33 [00:03<00:08,  2.80it/s]Loading checkpoint shards:  33%|███▎      | 11/33 [00:04<00:08,  2.71it/s]Loading checkpoint shards:  36%|███▋      | 12/33 [00:04<00:07,  2.74it/s]Loading checkpoint shards:  39%|███▉      | 13/33 [00:04<00:07,  2.77it/s]Loading checkpoint shards:  42%|████▏     | 14/33 [00:05<00:06,  2.79it/s]Loading checkpoint shards:  45%|████▌     | 15/33 [00:05<00:06,  2.79it/s]Loading checkpoint shards:  48%|████▊     | 16/33 [00:05<00:06,  2.72it/s]Loading checkpoint shards:  52%|█████▏    | 17/33 [00:06<00:05,  2.79it/s]Loading checkpoint shards:  55%|█████▍    | 18/33 [00:06<00:05,  2.80it/s]Loading checkpoint shards:  58%|█████▊    | 19/33 [00:06<00:04,  2.85it/s]Loading checkpoint shards:  61%|██████    | 20/33 [00:07<00:04,  2.89it/s]Loading checkpoint shards:  64%|██████▎   | 21/33 [00:07<00:04,  2.91it/s]Loading checkpoint shards:  67%|██████▋   | 22/33 [00:07<00:03,  2.93it/s]Loading checkpoint shards:  70%|██████▉   | 23/33 [00:08<00:03,  2.94it/s]Loading checkpoint shards:  73%|███████▎  | 24/33 [00:08<00:03,  2.94it/s]Loading checkpoint shards:  76%|███████▌  | 25/33 [00:08<00:02,  2.94it/s]Loading checkpoint shards:  79%|███████▉  | 26/33 [00:09<00:02,  2.94it/s]Loading checkpoint shards:  82%|████████▏ | 27/33 [00:09<00:02,  2.95it/s]Loading checkpoint shards:  85%|████████▍ | 28/33 [00:09<00:01,  2.98it/s]Loading checkpoint shards:  88%|████████▊ | 29/33 [00:10<00:01,  3.01it/s]Loading checkpoint shards:  91%|█████████ | 30/33 [00:10<00:01,  2.99it/s]Loading checkpoint shards:  94%|█████████▍| 31/33 [00:10<00:00,  3.00it/s]Loading checkpoint shards:  97%|█████████▋| 32/33 [00:11<00:00,  2.99it/s]Loading checkpoint shards: 100%|██████████| 33/33 [00:11<00:00,  2.81it/s]Loading checkpoint shards: 100%|██████████| 33/33 [00:11<00:00,  2.84it/s]
The tokenizer class you load from this checkpoint is not the same type as the class this function is called from. It may result in unexpected tokenization. 
The tokenizer class you load from this checkpoint is 'LLaMATokenizer'. 
The class this function is called from is 'LlamaTokenizer'.
Found cached dataset json (/home/tricorder/yang/datasets/json/default-50b57c6e99b706ed/0.0.0/e347ab1c932092252e717ff3f949105a4dd28b27e842dd53157d2f72e276c2e4)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 406.23it/s]
Loading cached split indices for dataset at /home/tricorder/yang/datasets/json/default-50b57c6e99b706ed/0.0.0/e347ab1c932092252e717ff3f949105a4dd28b27e842dd53157d2f72e276c2e4/cache-221ef8c5005ddf18.arrow and /home/tricorder/yang/datasets/json/default-50b57c6e99b706ed/0.0.0/e347ab1c932092252e717ff3f949105a4dd28b27e842dd53157d2f72e276c2e4/cache-493ce87b5905320b.arrow
Checkpoint  /adapter_model.bin not found
trainable params: 4194304 || all params: 6742609920 || trainable%: 0.06220594176090199
Map:   0%|          | 0/50002 [00:00<?, ? examples/s]Map:   0%|          | 126/50002 [00:00<00:40, 1246.19 examples/s]Map:   1%|          | 266/50002 [00:00<00:37, 1324.80 examples/s]Map:   1%|          | 409/50002 [00:00<00:36, 1367.36 examples/s]Map:   1%|          | 609/50002 [00:00<00:36, 1345.07 examples/s]Map:   2%|▏         | 755/50002 [00:00<00:35, 1378.24 examples/s]Map:   2%|▏         | 958/50002 [00:00<00:35, 1363.04 examples/s]Map:   2%|▏         | 1145/50002 [00:00<00:38, 1278.73 examples/s]Map:   3%|▎         | 1288/50002 [00:00<00:37, 1314.05 examples/s]Map:   3%|▎         | 1438/50002 [00:01<00:35, 1360.23 examples/s]Map:   3%|▎         | 1587/50002 [00:01<00:34, 1393.73 examples/s]Map:   3%|▎         | 1731/50002 [00:01<00:34, 1404.26 examples/s]Map:   4%|▍         | 1947/50002 [00:01<00:33, 1414.18 examples/s]Map:   4%|▍         | 2144/50002 [00:01<00:36, 1321.59 examples/s]Map:   5%|▍         | 2287/50002 [00:01<00:35, 1345.94 examples/s]Map:   5%|▍         | 2434/50002 [00:01<00:34, 1375.63 examples/s]Map:   5%|▌         | 2574/50002 [00:01<00:34, 1378.54 examples/s]Map:   5%|▌         | 2718/50002 [00:01<00:34, 1390.04 examples/s]Map:   6%|▌         | 2872/50002 [00:02<00:32, 1431.09 examples/s]Map:   6%|▌         | 3070/50002 [00:02<00:35, 1318.78 examples/s]Map:   6%|▋         | 3218/50002 [00:02<00:34, 1357.91 examples/s]Map:   7%|▋         | 3363/50002 [00:02<00:33, 1381.69 examples/s]Map:   7%|▋         | 3509/50002 [00:02<00:33, 1398.81 examples/s]Map:   7%|▋         | 3724/50002 [00:02<00:32, 1408.39 examples/s]Map:   8%|▊         | 3870/50002 [00:02<00:32, 1421.03 examples/s]Map:   8%|▊         | 4076/50002 [00:02<00:34, 1336.67 examples/s]Map:   8%|▊         | 4223/50002 [00:03<00:33, 1366.34 examples/s]Map:   9%|▊         | 4370/50002 [00:03<00:32, 1392.14 examples/s]Map:   9%|▉         | 4520/50002 [00:03<00:32, 1418.41 examples/s]Map:   9%|▉         | 4664/50002 [00:03<00:31, 1418.04 examples/s]Map:  10%|▉         | 4813/50002 [00:03<00:31, 1436.13 examples/s]Map:  10%|▉         | 5000/50002 [00:03<00:34, 1303.79 examples/s]Map:  10%|█         | 5143/50002 [00:03<00:33, 1335.20 examples/s]Map:  11%|█         | 5281/50002 [00:03<00:33, 1345.72 examples/s]Map:  11%|█         | 5425/50002 [00:03<00:32, 1370.27 examples/s]Map:  11%|█         | 5565/50002 [00:04<00:32, 1374.94 examples/s]Map:  11%|█▏        | 5714/50002 [00:04<00:31, 1401.62 examples/s]Map:  12%|█▏        | 5860/50002 [00:04<00:31, 1418.40 examples/s]Map:  12%|█▏        | 6072/50002 [00:04<00:33, 1323.43 examples/s]Map:  12%|█▏        | 6214/50002 [00:04<00:32, 1347.18 examples/s]Map:  13%|█▎        | 6357/50002 [00:04<00:31, 1366.97 examples/s]Map:  13%|█▎        | 6565/50002 [00:04<00:31, 1369.07 examples/s]Map:  13%|█▎        | 6708/50002 [00:04<00:31, 1382.51 examples/s]Map:  14%|█▎        | 6848/50002 [00:04<00:31, 1384.88 examples/s]Map:  14%|█▍        | 6990/50002 [00:05<00:30, 1393.92 examples/s]Map:  14%|█▍        | 7158/50002 [00:05<00:33, 1289.70 examples/s]Map:  15%|█▍        | 7298/50002 [00:05<00:32, 1318.06 examples/s]Map:  15%|█▍        | 7449/50002 [00:05<00:31, 1365.78 examples/s]Map:  15%|█▌        | 7591/50002 [00:05<00:30, 1379.73 examples/s]Map:  16%|█▌        | 7792/50002 [00:05<00:31, 1359.55 examples/s]Map:  16%|█▌        | 7998/50002 [00:05<00:30, 1361.87 examples/s]Map:  16%|█▋        | 8167/50002 [00:06<00:32, 1281.79 examples/s]Map:  17%|█▋        | 8309/50002 [00:06<00:31, 1310.79 examples/s]Map:  17%|█▋        | 8450/50002 [00:06<00:31, 1334.77 examples/s]Map:  17%|█▋        | 8587/50002 [00:06<00:30, 1343.35 examples/s]Map:  17%|█▋        | 8725/50002 [00:06<00:30, 1349.91 examples/s]Map:  18%|█▊        | 8864/50002 [00:06<00:30, 1359.55 examples/s]Map:  18%|█▊        | 9069/50002 [00:06<00:32, 1269.83 examples/s]Map:  18%|█▊        | 9213/50002 [00:06<00:31, 1308.68 examples/s]Map:  19%|█▊        | 9352/50002 [00:06<00:30, 1326.71 examples/s]Map:  19%|█▉        | 9487/50002 [00:06<00:30, 1329.94 examples/s]Map:  19%|█▉        | 9625/50002 [00:07<00:30, 1341.39 examples/s]Map:  20%|█▉        | 9768/50002 [00:07<00:29, 1364.74 examples/s]Map:  20%|█▉        | 9908/50002 [00:07<00:29, 1371.84 examples/s]Map:  20%|██        | 10085/50002 [00:07<00:30, 1289.99 examples/s]Map:  20%|██        | 10227/50002 [00:07<00:30, 1322.82 examples/s]Map:  21%|██        | 10367/50002 [00:07<00:29, 1338.03 examples/s]Map:  21%|██        | 10504/50002 [00:07<00:29, 1342.87 examples/s]Map:  21%|██▏       | 10647/50002 [00:07<00:28, 1361.29 examples/s]Map:  22%|██▏       | 10791/50002 [00:07<00:28, 1383.08 examples/s]Map:  22%|██▏       | 11000/50002 [00:08<00:30, 1281.65 examples/s]Map:  22%|██▏       | 11142/50002 [00:08<00:29, 1315.26 examples/s]Map:  23%|██▎       | 11284/50002 [00:08<00:28, 1338.06 examples/s]Map:  23%|██▎       | 11489/50002 [00:08<00:28, 1341.95 examples/s]Map:  23%|██▎       | 11694/50002 [00:08<00:28, 1348.54 examples/s]Map:  24%|██▎       | 11834/50002 [00:08<00:28, 1356.93 examples/s]Map:  24%|██▍       | 11974/50002 [00:08<00:27, 1360.50 examples/s]Map:  24%|██▍       | 12137/50002 [00:08<00:30, 1257.81 examples/s]Map:  25%|██▍       | 12279/50002 [00:09<00:29, 1293.96 examples/s]Map:  25%|██▍       | 12417/50002 [00:09<00:28, 1311.93 examples/s]Map:  25%|██▌       | 12562/50002 [00:09<00:27, 1344.66 examples/s]Map:  25%|██▌       | 12703/50002 [00:09<00:27, 1360.12 examples/s]Map:  26%|██▌       | 12851/50002 [00:09<00:26, 1390.53 examples/s]Map:  26%|██▌       | 12996/50002 [00:09<00:26, 1403.08 examples/s]Map:  26%|██▋       | 13175/50002 [00:09<00:27, 1320.45 examples/s]Map:  27%|██▋       | 13316/50002 [00:09<00:27, 1340.92 examples/s]Map:  27%|██▋       | 13525/50002 [00:10<00:26, 1359.02 examples/s]Map:  27%|██▋       | 13663/50002 [00:10<00:26, 1362.22 examples/s]Map:  28%|██▊       | 13800/50002 [00:10<00:26, 1359.87 examples/s]Map:  28%|██▊       | 13948/50002 [00:10<00:25, 1390.13 examples/s]Map:  28%|██▊       | 14149/50002 [00:10<00:27, 1315.09 examples/s]Map:  29%|██▊       | 14289/50002 [00:10<00:26, 1334.58 examples/s]Map:  29%|██▉       | 14431/50002 [00:10<00:26, 1355.41 examples/s]Map:  29%|██▉       | 14573/50002 [00:10<00:25, 1370.58 examples/s]Map:  29%|██▉       | 14717/50002 [00:10<00:25, 1388.59 examples/s]Map:  30%|██▉       | 14862/50002 [00:10<00:25, 1405.59 examples/s]Map:  30%|███       | 15079/50002 [00:11<00:26, 1323.67 examples/s]Map:  30%|███       | 15221/50002 [00:11<00:25, 1344.23 examples/s]Map:  31%|███       | 15369/50002 [00:11<00:25, 1377.98 examples/s]Map:  31%|███       | 15517/50002 [00:11<00:24, 1404.70 examples/s]Map:  31%|███▏      | 15729/50002 [00:11<00:24, 1404.78 examples/s]Map:  32%|███▏      | 15944/50002 [00:11<00:24, 1410.82 examples/s]Map:  32%|███▏      | 16139/50002 [00:11<00:25, 1305.86 examples/s]Map:  33%|███▎      | 16285/50002 [00:12<00:25, 1339.57 examples/s]Map:  33%|███▎      | 16423/50002 [00:12<00:24, 1348.00 examples/s]Map:  33%|███▎      | 16624/50002 [00:12<00:24, 1342.72 examples/s]Map:  34%|███▎      | 16767/50002 [00:12<00:24, 1360.97 examples/s]Map:  34%|███▍      | 16914/50002 [00:12<00:23, 1385.69 examples/s]Map:  34%|███▍      | 17076/50002 [00:12<00:25, 1274.91 examples/s]Map:  34%|███▍      | 17219/50002 [00:12<00:25, 1308.71 examples/s]Map:  35%|███▍      | 17357/50002 [00:12<00:24, 1327.09 examples/s]Map:  35%|███▌      | 17502/50002 [00:12<00:23, 1358.69 examples/s]Map:  35%|███▌      | 17651/50002 [00:13<00:23, 1392.51 examples/s]Map:  36%|███▌      | 17799/50002 [00:13<00:22, 1411.08 examples/s]Map:  36%|███▌      | 17947/50002 [00:13<00:22, 1430.76 examples/s]Map:  36%|███▋      | 18136/50002 [00:13<00:24, 1298.45 examples/s]Map:  37%|███▋      | 18279/50002 [00:13<00:23, 1329.19 examples/s]Map:  37%|███▋      | 18420/50002 [00:13<00:23, 1348.99 examples/s]Map:  37%|███▋      | 18630/50002 [00:13<00:23, 1362.59 examples/s]Map:  38%|███▊      | 18774/50002 [00:13<00:22, 1382.40 examples/s]Map:  38%|███▊      | 18920/50002 [00:13<00:22, 1400.84 examples/s]Map:  38%|███▊      | 19098/50002 [00:14<00:23, 1317.66 examples/s]Map:  38%|███▊      | 19240/50002 [00:14<00:22, 1340.83 examples/s]Map:  39%|███▉      | 19447/50002 [00:14<00:22, 1351.89 examples/s]Map:  39%|███▉      | 19592/50002 [00:14<00:22, 1374.73 examples/s]Map:  39%|███▉      | 19736/50002 [00:14<00:21, 1391.59 examples/s]Map:  40%|███▉      | 19888/50002 [00:14<00:21, 1421.71 examples/s]Map:  40%|████      | 20073/50002 [00:14<00:22, 1336.79 examples/s]Map:  40%|████      | 20224/50002 [00:14<00:21, 1378.29 examples/s]Map:  41%|████      | 20430/50002 [00:15<00:21, 1375.45 examples/s]Map:  41%|████      | 20573/50002 [00:15<00:21, 1386.48 examples/s]Map:  41%|████▏     | 20717/50002 [00:15<00:20, 1398.67 examples/s]Map:  42%|████▏     | 20864/50002 [00:15<00:20, 1414.31 examples/s]Map:  42%|████▏     | 21024/50002 [00:15<00:22, 1280.54 examples/s]Map:  42%|████▏     | 21167/50002 [00:15<00:21, 1314.46 examples/s]Map:  43%|████▎     | 21319/50002 [00:15<00:20, 1367.06 examples/s]Map:  43%|████▎     | 21459/50002 [00:15<00:20, 1375.63 examples/s]Map:  43%|████▎     | 21600/50002 [00:15<00:20, 1381.94 examples/s]Map:  43%|████▎     | 21741/50002 [00:16<00:20, 1387.34 examples/s]Map:  44%|████▍     | 21882/50002 [00:16<00:20, 1388.24 examples/s]Map:  44%|████▍     | 22072/50002 [00:16<00:21, 1302.39 examples/s]Map:  44%|████▍     | 22215/50002 [00:16<00:20, 1334.66 examples/s]Map:  45%|████▍     | 22352/50002 [00:16<00:20, 1343.42 examples/s]Map:  45%|████▍     | 22490/50002 [00:16<00:20, 1349.25 examples/s]Map:  45%|████▌     | 22630/50002 [00:16<00:20, 1361.44 examples/s]Map:  46%|████▌     | 22771/50002 [00:16<00:19, 1369.83 examples/s]Map:  46%|████▌     | 22917/50002 [00:16<00:19, 1392.91 examples/s]Map:  46%|████▌     | 23083/50002 [00:17<00:21, 1279.52 examples/s]Map:  46%|████▋     | 23220/50002 [00:17<00:20, 1302.79 examples/s]Map:  47%|████▋     | 23367/50002 [00:17<00:19, 1347.59 examples/s]Map:  47%|████▋     | 23511/50002 [00:17<00:19, 1371.20 examples/s]Map:  47%|████▋     | 23656/50002 [00:17<00:18, 1389.52 examples/s]Map:  48%|████▊     | 23801/50002 [00:17<00:18, 1405.08 examples/s]Map:  48%|████▊     | 23953/50002 [00:17<00:18, 1432.27 examples/s]Map:  48%|████▊     | 24146/50002 [00:17<00:19, 1331.26 examples/s]Map:  49%|████▊     | 24352/50002 [00:17<00:19, 1341.22 examples/s]Map:  49%|████▉     | 24490/50002 [00:18<00:18, 1347.27 examples/s]Map:  49%|████▉     | 24630/50002 [00:18<00:18, 1359.96 examples/s]Map:  50%|████▉     | 24770/50002 [00:18<00:18, 1367.00 examples/s]Map:  50%|████▉     | 24986/50002 [00:18<00:18, 1385.26 examples/s]Map:  50%|█████     | 25155/50002 [00:18<00:19, 1292.16 examples/s]Map:  51%|█████     | 25301/50002 [00:18<00:18, 1330.78 examples/s]Map:  51%|█████     | 25438/50002 [00:18<00:18, 1336.21 examples/s]Map:  51%|█████     | 25579/50002 [00:18<00:18, 1355.95 examples/s]Map:  51%|█████▏    | 25719/50002 [00:18<00:17, 1365.93 examples/s]Map:  52%|█████▏    | 25873/50002 [00:19<00:17, 1409.81 examples/s]Map:  52%|█████▏    | 26073/50002 [00:19<00:18, 1302.26 examples/s]Map:  52%|█████▏    | 26215/50002 [00:19<00:17, 1326.92 examples/s]Map:  53%|█████▎    | 26363/50002 [00:19<00:17, 1364.00 examples/s]Map:  53%|█████▎    | 26511/50002 [00:19<00:16, 1390.97 examples/s]Map:  53%|█████▎    | 26656/50002 [00:19<00:16, 1403.62 examples/s]Map:  54%|█████▎    | 26801/50002 [00:19<00:16, 1411.20 examples/s]Map:  54%|█████▍    | 26945/50002 [00:19<00:16, 1415.57 examples/s]Map:  54%|█████▍    | 27134/50002 [00:20<00:17, 1285.56 examples/s]Map:  55%|█████▍    | 27277/50002 [00:20<00:17, 1320.01 examples/s]Map:  55%|█████▍    | 27419/50002 [00:20<00:16, 1345.85 examples/s]Map:  55%|█████▌    | 27557/50002 [00:20<00:16, 1352.18 examples/s]Map:  56%|█████▌    | 27763/50002 [00:20<00:16, 1353.59 examples/s]Map:  56%|█████▌    | 27907/50002 [00:20<00:16, 1375.06 examples/s]Map:  56%|█████▌    | 28072/50002 [00:20<00:17, 1272.83 examples/s]Map:  56%|█████▋    | 28220/50002 [00:20<00:16, 1323.22 examples/s]Map:  57%|█████▋    | 28364/50002 [00:20<00:16, 1350.97 examples/s]Map:  57%|█████▋    | 28578/50002 [00:21<00:15, 1376.73 examples/s]Map:  57%|█████▋    | 28723/50002 [00:21<00:15, 1391.42 examples/s]Map:  58%|█████▊    | 28872/50002 [00:21<00:14, 1414.57 examples/s]Map:  58%|█████▊    | 29070/50002 [00:21<00:15, 1324.57 examples/s]Map:  58%|█████▊    | 29216/50002 [00:21<00:15, 1353.94 examples/s]Map:  59%|█████▉    | 29420/50002 [00:21<00:15, 1354.74 examples/s]Map:  59%|█████▉    | 29572/50002 [00:21<00:14, 1389.89 examples/s]Map:  59%|█████▉    | 29716/50002 [00:21<00:14, 1400.32 examples/s]Map:  60%|█████▉    | 29864/50002 [00:22<00:14, 1417.56 examples/s]Map:  60%|██████    | 30070/50002 [00:22<00:15, 1316.74 examples/s]Map:  61%|██████    | 30272/50002 [00:22<00:14, 1322.42 examples/s]Map:  61%|██████    | 30413/50002 [00:22<00:14, 1340.67 examples/s]Map:  61%|██████    | 30616/50002 [00:22<00:14, 1342.62 examples/s]Map:  62%|██████▏   | 30759/50002 [00:22<00:14, 1360.73 examples/s]Map:  62%|██████▏   | 30898/50002 [00:22<00:14, 1362.91 examples/s]Map:  62%|██████▏   | 31075/50002 [00:22<00:14, 1274.00 examples/s]Map:  62%|██████▏   | 31221/50002 [00:23<00:14, 1317.88 examples/s]Map:  63%|██████▎   | 31361/50002 [00:23<00:13, 1337.96 examples/s]Map:  63%|██████▎   | 31501/50002 [00:23<00:13, 1351.79 examples/s]Map:  63%|██████▎   | 31709/50002 [00:23<00:13, 1363.13 examples/s]Map:  64%|██████▎   | 31853/50002 [00:23<00:13, 1379.26 examples/s]Map:  64%|██████▍   | 32000/50002 [00:23<00:13, 1295.98 examples/s]Map:  64%|██████▍   | 32144/50002 [00:23<00:13, 1329.09 examples/s]Map:  65%|██████▍   | 32290/50002 [00:23<00:13, 1361.35 examples/s]Map:  65%|██████▍   | 32432/50002 [00:23<00:12, 1376.26 examples/s]Map:  65%|██████▌   | 32639/50002 [00:24<00:12, 1375.58 examples/s]Map:  66%|██████▌   | 32784/50002 [00:24<00:12, 1391.23 examples/s]Map:  66%|██████▌   | 32994/50002 [00:24<00:12, 1391.91 examples/s]Map:  66%|██████▋   | 33166/50002 [00:24<00:12, 1305.49 examples/s]Map:  67%|██████▋   | 33307/50002 [00:24<00:12, 1328.03 examples/s]Map:  67%|██████▋   | 33511/50002 [00:24<00:12, 1334.70 examples/s]Map:  67%|██████▋   | 33653/50002 [00:24<00:12, 1353.52 examples/s]Map:  68%|██████▊   | 33790/50002 [00:24<00:11, 1355.19 examples/s]Map:  68%|██████▊   | 33934/50002 [00:25<00:11, 1376.58 examples/s]Map:  68%|██████▊   | 34141/50002 [00:25<00:12, 1278.41 examples/s]Map:  69%|██████▊   | 34287/50002 [00:25<00:11, 1320.70 examples/s]Map:  69%|██████▉   | 34428/50002 [00:25<00:11, 1341.94 examples/s]Map:  69%|██████▉   | 34566/50002 [00:25<00:11, 1349.82 examples/s]Map:  69%|██████▉   | 34704/50002 [00:25<00:11, 1355.14 examples/s]Map:  70%|██████▉   | 34852/50002 [00:25<00:10, 1387.17 examples/s]Map:  70%|██████▉   | 34992/50002 [00:25<00:10, 1386.90 examples/s]Map:  70%|███████   | 35152/50002 [00:25<00:11, 1261.41 examples/s]Map:  71%|███████   | 35300/50002 [00:26<00:11, 1319.20 examples/s]Map:  71%|███████   | 35437/50002 [00:26<00:10, 1330.04 examples/s]Map:  71%|███████   | 35580/50002 [00:26<00:10, 1354.72 examples/s]Map:  72%|███████▏  | 35787/50002 [00:26<00:10, 1361.68 examples/s]Map:  72%|███████▏  | 35927/50002 [00:26<00:10, 1366.62 examples/s]Map:  72%|███████▏  | 36072/50002 [00:26<00:10, 1282.57 examples/s]Map:  72%|███████▏  | 36214/50002 [00:26<00:10, 1312.02 examples/s]Map:  73%|███████▎  | 36414/50002 [00:26<00:10, 1315.63 examples/s]Map:  73%|███████▎  | 36557/50002 [00:27<00:10, 1343.36 examples/s]Map:  73%|███████▎  | 36700/50002 [00:27<00:09, 1364.07 examples/s]Map:  74%|███████▎  | 36843/50002 [00:27<00:09, 1379.64 examples/s]Map:  74%|███████▍  | 36983/50002 [00:27<00:09, 1382.12 examples/s]Map:  74%|███████▍  | 37157/50002 [00:27<00:09, 1294.41 examples/s]Map:  75%|███████▍  | 37303/50002 [00:27<00:09, 1335.66 examples/s]Map:  75%|███████▍  | 37446/50002 [00:27<00:09, 1359.75 examples/s]Map:  75%|███████▌  | 37595/50002 [00:27<00:08, 1394.97 examples/s]Map:  75%|███████▌  | 37749/50002 [00:27<00:08, 1435.72 examples/s]Map:  76%|███████▌  | 37959/50002 [00:28<00:08, 1415.61 examples/s]Map:  76%|███████▋  | 38143/50002 [00:28<00:09, 1316.12 examples/s]Map:  77%|███████▋  | 38297/50002 [00:28<00:08, 1369.33 examples/s]Map:  77%|███████▋  | 38445/50002 [00:28<00:08, 1396.77 examples/s]Map:  77%|███████▋  | 38599/50002 [00:28<00:07, 1428.26 examples/s]Map:  78%|███████▊  | 38810/50002 [00:28<00:07, 1416.04 examples/s]Map:  78%|███████▊  | 39000/50002 [00:28<00:08, 1320.76 examples/s]Map:  78%|███████▊  | 39146/50002 [00:28<00:08, 1353.04 examples/s]Map:  79%|███████▊  | 39291/50002 [00:29<00:07, 1373.63 examples/s]Map:  79%|███████▉  | 39435/50002 [00:29<00:07, 1389.63 examples/s]Map:  79%|███████▉  | 39584/50002 [00:29<00:07, 1413.59 examples/s]Map:  79%|███████▉  | 39728/50002 [00:29<00:07, 1419.39 examples/s]Map:  80%|███████▉  | 39883/50002 [00:29<00:06, 1452.78 examples/s]Map:  80%|████████  | 40073/50002 [00:29<00:07, 1325.23 examples/s]Map:  80%|████████  | 40220/50002 [00:29<00:07, 1362.12 examples/s]Map:  81%|████████  | 40361/50002 [00:29<00:07, 1372.01 examples/s]Map:  81%|████████  | 40566/50002 [00:29<00:06, 1366.88 examples/s]Map:  82%|████████▏ | 40763/50002 [00:30<00:06, 1345.52 examples/s]Map:  82%|████████▏ | 40964/50002 [00:30<00:06, 1341.21 examples/s]Map:  82%|████████▏ | 41140/50002 [00:30<00:07, 1246.84 examples/s]Map:  83%|████████▎ | 41287/50002 [00:30<00:06, 1293.76 examples/s]Map:  83%|████████▎ | 41423/50002 [00:30<00:06, 1306.11 examples/s]Map:  83%|████████▎ | 41625/50002 [00:30<00:06, 1316.01 examples/s]Map:  84%|████████▎ | 41769/50002 [00:30<00:06, 1344.99 examples/s]Map:  84%|████████▍ | 41913/50002 [00:30<00:05, 1365.73 examples/s]Map:  84%|████████▍ | 42084/50002 [00:31<00:06, 1279.96 examples/s]Map:  84%|████████▍ | 42229/50002 [00:31<00:05, 1322.11 examples/s]Map:  85%|████████▍ | 42374/50002 [00:31<00:05, 1355.33 examples/s]Map:  85%|████████▌ | 42519/50002 [00:31<00:05, 1377.43 examples/s]Map:  85%|████████▌ | 42673/50002 [00:31<00:05, 1417.01 examples/s]Map:  86%|████████▌ | 42819/50002 [00:31<00:05, 1423.50 examples/s]Map:  86%|████████▌ | 43000/50002 [00:31<00:05, 1306.56 examples/s]Map:  86%|████████▋ | 43137/50002 [00:31<00:05, 1320.55 examples/s]Map:  87%|████████▋ | 43284/50002 [00:31<00:04, 1356.25 examples/s]Map:  87%|████████▋ | 43488/50002 [00:32<00:04, 1355.19 examples/s]Map:  87%|████████▋ | 43628/50002 [00:32<00:04, 1364.23 examples/s]Map:  88%|████████▊ | 43772/50002 [00:32<00:04, 1381.90 examples/s]Map:  88%|████████▊ | 43985/50002 [00:32<00:04, 1392.63 examples/s]Map:  88%|████████▊ | 44159/50002 [00:32<00:04, 1305.73 examples/s]Map:  89%|████████▊ | 44301/50002 [00:32<00:04, 1332.51 examples/s]Map:  89%|████████▉ | 44446/50002 [00:32<00:04, 1361.41 examples/s]Map:  89%|████████▉ | 44595/50002 [00:32<00:03, 1385.33 examples/s]Map:  90%|████████▉ | 44801/50002 [00:33<00:03, 1378.85 examples/s]Map:  90%|████████▉ | 44942/50002 [00:33<00:03, 1383.76 examples/s]Map:  90%|█████████ | 45142/50002 [00:33<00:03, 1285.00 examples/s]Map:  91%|█████████ | 45284/50002 [00:33<00:03, 1313.88 examples/s]Map:  91%|█████████ | 45433/50002 [00:33<00:03, 1355.94 examples/s]Map:  91%|█████████ | 45579/50002 [00:33<00:03, 1380.83 examples/s]Map:  91%|█████████▏| 45720/50002 [00:33<00:03, 1387.00 examples/s]Map:  92%|█████████▏| 45869/50002 [00:33<00:02, 1412.23 examples/s]Map:  92%|█████████▏| 46070/50002 [00:34<00:03, 1310.04 examples/s]Map:  92%|█████████▏| 46210/50002 [00:34<00:02, 1331.55 examples/s]Map:  93%|█████████▎| 46355/50002 [00:34<00:02, 1358.68 examples/s]Map:  93%|█████████▎| 46564/50002 [00:34<00:02, 1368.51 examples/s]Map:  93%|█████████▎| 46705/50002 [00:34<00:02, 1375.50 examples/s]Map:  94%|█████████▎| 46849/50002 [00:34<00:02, 1388.27 examples/s]Map:  94%|█████████▍| 46990/50002 [00:34<00:02, 1390.78 examples/s]Map:  94%|█████████▍| 47159/50002 [00:34<00:02, 1289.46 examples/s]Map:  95%|█████████▍| 47300/50002 [00:34<00:02, 1317.33 examples/s]Map:  95%|█████████▍| 47440/50002 [00:35<00:01, 1339.56 examples/s]Map:  95%|█████████▌| 47640/50002 [00:35<00:01, 1333.11 examples/s]Map:  96%|█████████▌| 47777/50002 [00:35<00:01, 1341.88 examples/s]Map:  96%|█████████▌| 47920/50002 [00:35<00:01, 1363.46 examples/s]Map:  96%|█████████▌| 48085/50002 [00:35<00:01, 1263.17 examples/s]Map:  96%|█████████▋| 48233/50002 [00:35<00:01, 1314.49 examples/s]Map:  97%|█████████▋| 48373/50002 [00:35<00:01, 1336.07 examples/s]Map:  97%|█████████▋| 48524/50002 [00:35<00:01, 1382.78 examples/s]Map:  97%|█████████▋| 48732/50002 [00:36<00:00, 1379.57 examples/s]Map:  98%|█████████▊| 48877/50002 [00:36<00:00, 1396.55 examples/s]Map:  98%|█████████▊| 49074/50002 [00:36<00:00, 1296.79 examples/s]Map:  98%|█████████▊| 49214/50002 [00:36<00:00, 1320.14 examples/s]Map:  99%|█████████▊| 49357/50002 [00:36<00:00, 1346.41 examples/s]Map:  99%|█████████▉| 49500/50002 [00:36<00:00, 1366.59 examples/s]Map:  99%|█████████▉| 49647/50002 [00:36<00:00, 1393.28 examples/s]Map: 100%|█████████▉| 49795/50002 [00:36<00:00, 1416.92 examples/s]Map: 100%|█████████▉| 50000/50002 [00:36<00:00, 1313.41 examples/s]                                                                   Map:   0%|          | 0/2000 [00:00<?, ? examples/s]Map:   8%|▊         | 161/2000 [00:00<00:01, 1586.35 examples/s]Map:  19%|█▊        | 372/2000 [00:00<00:01, 1458.83 examples/s]Map:  29%|██▉       | 581/2000 [00:00<00:00, 1419.72 examples/s]Map:  36%|███▋      | 729/2000 [00:00<00:00, 1436.85 examples/s]Map:  44%|████▍     | 875/2000 [00:00<00:00, 1438.74 examples/s]Map:  54%|█████▎    | 1071/2000 [00:00<00:00, 1332.41 examples/s]Map:  60%|██████    | 1208/2000 [00:00<00:00, 1340.35 examples/s]Map:  67%|██████▋   | 1349/2000 [00:00<00:00, 1355.72 examples/s]Map:  75%|███████▍  | 1498/2000 [00:01<00:00, 1390.42 examples/s]Map:  82%|████████▏ | 1643/2000 [00:01<00:00, 1406.70 examples/s]Map:  93%|█████████▎| 1857/2000 [00:01<00:00, 1411.00 examples/s]Map: 100%|██████████| 2000/2000 [00:01<00:00, 1295.62 examples/s]                                                                 wandb: Currently logged in as: gaoxiaoce0428. Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.15.2
wandb: Run data is saved locally in /home/tricorder/test/gxc/alpaca_lora_env/alpaca-lora/wandb/run-20230506_111320-n3ntedig
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run  
wandb: ⭐️ View project at https://wandb.ai/gaoxiaoce0428/llama_test_project
wandb: 🚀 View run at https://wandb.ai/gaoxiaoce0428/llama_test_project/runs/n3ntedig
  0%|          | 0/144 [00:00<?, ?it/s]/home/tricorder/yang/anaconda3/envs/llama_alpaca_lora/lib/python3.10/site-packages/bitsandbytes/autograd/_functions.py:318: UserWarning: MatMul8bitLt: inputs will be cast from torch.float32 to float16 during quantization
  warnings.warn(f"MatMul8bitLt: inputs will be cast from {A.dtype} to float16 during quantization")
  1%|          | 1/144 [06:44<16:04:39, 404.76s/it]  1%|▏         | 2/144 [12:02<13:56:27, 353.43s/it]  2%|▏         | 3/144 [16:55<12:45:34, 325.78s/it]  3%|▎         | 4/144 [21:32<11:55:24, 306.61s/it]  3%|▎         | 5/144 [25:59<11:17:11, 292.31s/it]  4%|▍         | 6/144 [30:09<10:39:10, 277.90s/it]  5%|▍         | 7/144 [34:08<10:05:58, 265.39s/it]  6%|▌         | 8/144 [37:59<9:36:13, 254.22s/it]   6%|▋         | 9/144 [41:44<9:11:45, 245.22s/it]  7%|▋         | 10/144 [45:24<8:50:13, 237.41s/it]                                                     7%|▋         | 10/144 [45:24<8:50:13, 237.41s/it]  8%|▊         | 11/144 [48:57<8:29:30, 229.86s/it]  8%|▊         | 12/144 [52:19<8:07:28, 221.58s/it]  9%|▉         | 13/144 [59:13<10:10:48, 279.76s/it] 10%|▉         | 14/144 [1:04:35<10:33:35, 292.42s/it] 10%|█         | 15/144 [1:09:32<10:32:09, 294.02s/it] 11%|█         | 16/144 [1:14:08<10:15:11, 288.37s/it] 12%|█▏        | 17/144 [1:18:36<9:57:30, 282.29s/it]  12%|█▎        | 18/144 [1:22:45<9:32:09, 272.46s/it] 13%|█▎        | 19/144 [1:26:46<9:07:39, 262.88s/it] 14%|█▍        | 20/144 [1:30:39<8:44:41, 253.88s/it]                                                      14%|█▍        | 20/144 [1:30:39<8:44:41, 253.88s/it] 15%|█▍        | 21/144 [1:34:25<8:23:29, 245.61s/it] 15%|█▌        | 22/144 [1:38:05<8:03:30, 237.79s/it] 16%|█▌        | 23/144 [1:41:37<7:44:17, 230.23s/it] 17%|█▋        | 24/144 [1:45:02<7:24:50, 222.42s/it] 17%|█▋        | 25/144 [1:51:49<9:11:17, 277.96s/it] 18%|█▊        | 26/144 [1:57:08<9:30:47, 290.23s/it] 19%|█▉        | 27/144 [2:02:02<9:28:14, 291.40s/it] 19%|█▉        | 28/144 [2:06:38<9:14:15, 286.69s/it] 20%|██        | 29/144 [2:11:03<8:57:20, 280.35s/it] 21%|██        | 30/144 [2:15:15<8:36:06, 271.64s/it]                                                      21%|██        | 30/144 [2:15:15<8:36:06, 271.64s/it] 22%|██▏       | 31/144 [2:19:17<8:14:52, 262.76s/it] 22%|██▏       | 32/144 [2:23:08<7:53:04, 253.43s/it] 23%|██▎       | 33/144 [2:26:56<7:34:40, 245.77s/it] 24%|██▎       | 34/144 [2:30:35<7:15:42, 237.66s/it] 24%|██▍       | 35/144 [2:34:08<6:58:17, 230.26s/it] 25%|██▌       | 36/144 [2:37:32<6:40:21, 222.42s/it] 26%|██▌       | 37/144 [2:44:19<8:15:30, 277.85s/it] 26%|██▋       | 38/144 [2:49:38<8:32:35, 290.15s/it] 27%|██▋       | 39/144 [2:57:14<9:54:53, 339.94s/it] 28%|██▊       | 40/144 [3:06:15<11:33:52, 400.31s/it]                                                       28%|██▊       | 40/144 [3:06:15<11:33:52, 400.31s/it] 28%|██▊       | 41/144 [3:14:49<12:25:22, 434.19s/it] 29%|██▉       | 42/144 [3:22:43<12:38:22, 446.10s/it] 30%|██▉       | 43/144 [3:30:06<12:29:43, 445.38s/it] 31%|███       | 44/144 [3:37:09<12:10:53, 438.54s/it] 31%|███▏      | 45/144 [3:44:01<11:50:39, 430.71s/it] 32%|███▏      | 46/144 [3:50:55<11:35:10, 425.62s/it] 33%|███▎      | 47/144 [3:57:13<11:05:00, 411.34s/it] 33%|███▎      | 48/144 [4:03:30<10:41:38, 401.02s/it] 34%|███▍      | 49/144 [4:11:33<11:13:52, 425.60s/it] 35%|███▍      | 50/144 [4:21:08<12:16:56, 470.38s/it]                                                       35%|███▍      | 50/144 [4:21:08<12:16:56, 470.38s/it] 35%|███▌      | 51/144 [4:30:35<12:54:10, 499.46s/it] 36%|███▌      | 52/144 [4:39:57<13:14:28, 518.13s/it] 37%|███▋      | 53/144 [4:48:42<13:08:48, 520.09s/it] 38%|███▊      | 54/144 [4:56:29<12:36:29, 504.33s/it] 38%|███▊      | 55/144 [5:04:22<12:14:09, 494.94s/it] 39%|███▉      | 56/144 [5:11:35<11:38:44, 476.41s/it] 40%|███▉      | 57/144 [5:18:42<11:09:09, 461.49s/it] 40%|████      | 58/144 [5:25:29<10:38:02, 445.14s/it] 41%|████      | 59/144 [5:31:56<10:06:07, 427.86s/it] 42%|████▏     | 60/144 [5:38:17<9:39:10, 413.69s/it]                                                       42%|████▏     | 60/144 [5:38:17<9:39:10, 413.69s/it] 42%|████▏     | 61/144 [5:45:09<9:31:23, 413.06s/it] 43%|████▎     | 62/144 [5:54:37<10:28:12, 459.66s/it] 44%|████▍     | 63/144 [6:04:23<11:11:28, 497.39s/it] 44%|████▍     | 64/144 [6:13:53<11:32:21, 519.27s/it] 45%|████▌     | 65/144 [6:22:37<11:25:43, 520.80s/it] 46%|████▌     | 66/144 [6:30:49<11:05:36, 512.01s/it] 47%|████▋     | 67/144 [6:38:22<10:34:18, 494.27s/it] 47%|████▋     | 68/144 [6:45:28<10:00:11, 473.83s/it] 48%|████▊     | 69/144 [6:52:23<9:30:17, 456.23s/it]  49%|████▊     | 70/144 [6:58:04<8:40:10, 421.77s/it]                                                      49%|████▊     | 70/144 [6:58:04<8:40:10, 421.77s/it] 49%|████▉     | 71/144 [7:04:26<8:18:25, 409.67s/it] 50%|█████     | 72/144 [7:10:48<8:01:38, 401.36s/it] 51%|█████     | 73/144 [7:17:45<8:00:37, 406.17s/it] 51%|█████▏    | 74/144 [7:27:12<8:50:17, 454.54s/it] 52%|█████▏    | 75/144 [7:37:03<9:29:49, 495.49s/it] 53%|█████▎    | 76/144 [7:45:59<9:35:15, 507.58s/it] 53%|█████▎    | 77/144 [7:54:48<9:33:51, 513.91s/it] 54%|█████▍    | 78/144 [8:02:24<9:06:11, 496.54s/it] 55%|█████▍    | 79/144 [8:09:55<8:43:02, 482.80s/it] 56%|█████▌    | 80/144 [8:16:35<8:08:42, 458.17s/it]                                                      56%|█████▌    | 80/144 [8:16:35<8:08:42, 458.17s/it] 56%|█████▋    | 81/144 [8:23:12<7:41:44, 439.75s/it] 57%|█████▋    | 82/144 [8:28:42<7:00:12, 406.66s/it] 58%|█████▊    | 83/144 [8:34:40<6:38:38, 392.11s/it] 58%|█████▊    | 84/144 [8:40:30<6:19:25, 379.43s/it] 59%|█████▉    | 85/144 [8:47:06<6:18:14, 384.65s/it] 60%|█████▉    | 86/144 [8:56:34<7:04:47, 439.44s/it] 60%|██████    | 87/144 [9:05:28<7:24:33, 467.96s/it] 61%|██████    | 88/144 [9:14:41<7:40:33, 493.46s/it] 62%|██████▏   | 89/144 [9:23:29<7:41:55, 503.91s/it] 62%|██████▎   | 90/144 [9:31:37<7:29:02, 498.94s/it]                                                      62%|██████▎   | 90/144 [9:31:37<7:29:02, 498.94s/it] 63%|██████▎   | 91/144 [9:39:27<7:13:12, 490.43s/it] 64%|██████▍   | 92/144 [9:46:34<6:48:30, 471.36s/it] 65%|██████▍   | 93/144 [9:53:25<6:25:16, 453.27s/it] 65%|██████▌   | 94/144 [9:59:49<6:00:16, 432.34s/it] 66%|██████▌   | 95/144 [10:06:00<5:38:02, 413.92s/it] 67%|██████▋   | 96/144 [10:12:00<5:18:18, 397.89s/it] 67%|██████▋   | 97/144 [10:18:30<5:09:51, 395.56s/it] 68%|██████▊   | 98/144 [10:26:29<5:22:15, 420.34s/it] 69%|██████▉   | 99/144 [10:36:10<5:51:27, 468.62s/it] 69%|██████▉   | 100/144 [10:45:56<6:09:29, 503.85s/it]                                                        69%|██████▉   | 100/144 [10:45:56<6:09:29, 503.85s/it] 70%|███████   | 101/144 [10:54:20<6:01:04, 503.82s/it] 71%|███████   | 102/144 [11:01:50<5:41:27, 487.80s/it] 72%|███████▏  | 103/144 [11:09:20<5:25:39, 476.58s/it] 72%|███████▏  | 104/144 [11:16:35<5:09:24, 464.11s/it] 73%|███████▎  | 105/144 [11:23:14<4:48:55, 444.50s/it] 74%|███████▎  | 106/144 [11:29:53<4:32:47, 430.71s/it] 74%|███████▍  | 107/144 [11:35:47<4:11:22, 407.65s/it] 75%|███████▌  | 108/144 [11:41:37<3:54:17, 390.49s/it] 76%|███████▌  | 109/144 [11:46:34<3:31:23, 362.38s/it] 76%|███████▋  | 110/144 [11:54:28<3:44:19, 395.88s/it]                                                        76%|███████▋  | 110/144 [11:54:28<3:44:19, 395.88s/it] 77%|███████▋  | 111/144 [12:04:20<4:10:05, 454.70s/it] 78%|███████▊  | 112/144 [12:13:48<4:20:38, 488.71s/it] 78%|███████▊  | 113/144 [12:22:19<4:15:57, 495.40s/it] 79%|███████▉  | 114/144 [12:29:34<3:58:38, 477.27s/it] 80%|███████▉  | 115/144 [12:36:45<3:44:01, 463.49s/it] 81%|████████  | 116/144 [12:43:49<3:30:43, 451.56s/it] 81%|████████▏ | 117/144 [12:50:50<3:19:08, 442.55s/it] 82%|████████▏ | 118/144 [12:57:05<3:02:55, 422.15s/it] 83%|████████▎ | 119/144 [13:03:00<2:47:31, 402.08s/it] 83%|████████▎ | 120/144 [13:08:57<2:35:24, 388.52s/it]                                                        83%|████████▎ | 120/144 [13:08:57<2:35:24, 388.52s/it] 84%|████████▍ | 121/144 [13:13:44<2:17:17, 358.13s/it] 85%|████████▍ | 122/144 [13:21:23<2:22:23, 388.34s/it] 85%|████████▌ | 123/144 [13:31:23<2:38:05, 451.67s/it] 86%|████████▌ | 124/144 [13:40:36<2:40:45, 482.27s/it] 87%|████████▋ | 125/144 [13:48:54<2:34:10, 486.85s/it] 88%|████████▊ | 126/144 [13:55:31<2:18:01, 460.08s/it] 88%|████████▊ | 127/144 [14:02:49<2:08:27, 453.39s/it] 89%|████████▉ | 128/144 [14:09:36<1:57:11, 439.48s/it] 90%|████████▉ | 129/144 [14:15:46<1:44:38, 418.54s/it] 90%|█████████ | 130/144 [14:21:41<1:33:12, 399.45s/it]                                                        90%|█████████ | 130/144 [14:21:41<1:33:12, 399.45s/it] 91%|█████████ | 131/144 [14:26:19<1:18:41, 363.20s/it] 92%|█████████▏| 132/144 [14:32:27<1:12:55, 364.65s/it] 92%|█████████▏| 133/144 [14:37:22<1:02:58, 343.54s/it] 93%|█████████▎| 134/144 [14:45:12<1:03:34, 381.45s/it] 94%|█████████▍| 135/144 [14:54:35<1:05:23, 435.95s/it] 94%|█████████▍| 136/144 [15:04:11<1:03:43, 477.97s/it] 95%|█████████▌| 137/144 [15:13:17<58:08, 498.34s/it]   96%|█████████▌| 138/144 [15:21:48<50:13, 502.27s/it] 97%|█████████▋| 139/144 [15:29:19<40:33, 486.75s/it] 97%|█████████▋| 140/144 [15:36:45<31:39, 474.77s/it]                                                      97%|█████████▋| 140/144 [15:36:45<31:39, 474.77s/it] 98%|█████████▊| 141/144 [15:43:33<22:43, 454.56s/it] 99%|█████████▊| 142/144 [15:50:07<14:33, 436.53s/it] 99%|█████████▉| 143/144 [15:56:07<06:53, 413.41s/it]100%|██████████| 144/144 [16:02:16<00:00, 400.04s/it]                                                     100%|██████████| 144/144 [16:02:16<00:00, 400.04s/it]100%|██████████| 144/144 [16:02:16<00:00, 400.95s/it]
ERROR: Could not consume arg:  
Usage: finetune.py ' ' ' ' --base_model /home/tricorder/test/gxc/decapoda-research/llama-7b-hf ' ' ' ' --data_path ../data/alpaca_data.json ' ' ' ' --output_dir ../lora_alpaca_output_free ' ' ' ' --batch_size 1024 ' ' ' ' --micro_batch_size 4 ' ' ' ' --num_epochs 3 ' ' ' ' --learning_rate 2e-5 ' ' ' ' --cutoff_len 512 ' ' ' ' --val_set_size 2000 ' ' ' ' --lora_r

For detailed information on this command, run:
  finetune.py ' ' ' ' --base_model /home/tricorder/test/gxc/decapoda-research/llama-7b-hf ' ' ' ' --data_path ../data/alpaca_data.json ' ' ' ' --output_dir ../lora_alpaca_output_free ' ' ' ' --batch_size 1024 ' ' ' ' --micro_batch_size 4 ' ' ' ' --num_epochs 3 ' ' ' ' --learning_rate 2e-5 ' ' ' ' --cutoff_len 512 ' ' ' ' --val_set_size 2000 ' ' ' ' --lora_r --help
{'loss': 2.3375, 'learning_rate': 2.0000000000000003e-06, 'epoch': 0.2}
{'loss': 2.3641, 'learning_rate': 4.000000000000001e-06, 'epoch': 0.41}
{'loss': 2.3843, 'learning_rate': 6e-06, 'epoch': 0.61}
{'loss': 2.41, 'learning_rate': 8.000000000000001e-06, 'epoch': 0.82}
{'loss': 2.4353, 'learning_rate': 1e-05, 'epoch': 1.02}
{'loss': 2.2916, 'learning_rate': 1.2e-05, 'epoch': 1.23}
{'loss': 2.1325, 'learning_rate': 1.4e-05, 'epoch': 1.43}
{'loss': 2.0723, 'learning_rate': 1.6000000000000003e-05, 'epoch': 1.64}
{'loss': 1.9517, 'learning_rate': 1.8e-05, 'epoch': 1.84}
{'loss': 1.7462, 'learning_rate': 2e-05, 'epoch': 2.05}
{'loss': 1.4985, 'learning_rate': 1.5454545454545454e-05, 'epoch': 2.25}
{'loss': 1.3578, 'learning_rate': 1.0909090909090909e-05, 'epoch': 2.46}
{'loss': 1.3019, 'learning_rate': 6.363636363636364e-06, 'epoch': 2.66}
{'loss': 1.277, 'learning_rate': 1.8181818181818183e-06, 'epoch': 2.87}
{'train_runtime': 57741.3178, 'train_samples_per_second': 2.598, 'train_steps_per_second': 0.002, 'train_loss': 1.9481037656466167, 'epoch': 2.95}

 If there's a warning about missing keys above, please disregard :)
wandb: Waiting for W&B process to finish... (success).
wandb: 
wandb: Run history:
wandb:                    train/epoch ▁▂▂▃▃▄▄▅▅▆▆▇▇██
wandb:              train/global_step ▁▂▂▃▃▄▄▅▅▆▆▇▇██
wandb:            train/learning_rate ▁▂▃▃▄▅▆▆▇█▆▅▃▁
wandb:                     train/loss ▇████▇▆▆▅▄▂▁▁▁
wandb:               train/total_flos ▁
wandb:               train/train_loss ▁
wandb:            train/train_runtime ▁
wandb: train/train_samples_per_second ▁
wandb:   train/train_steps_per_second ▁
wandb: 
wandb: Run summary:
wandb:                    train/epoch 2.95
wandb:              train/global_step 144
wandb:            train/learning_rate 0.0
wandb:                     train/loss 1.277
wandb:               train/total_flos 7.740450085994496e+17
wandb:               train/train_loss 1.9481
wandb:            train/train_runtime 57741.3178
wandb: train/train_samples_per_second 2.598
wandb:   train/train_steps_per_second 0.002
wandb: 
wandb: 🚀 View run   at: https://wandb.ai/gaoxiaoce0428/llama_test_project/runs/n3ntedig
wandb: Synced 6 W&B file(s), 0 media file(s), 2 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20230506_111320-n3ntedig/logs
